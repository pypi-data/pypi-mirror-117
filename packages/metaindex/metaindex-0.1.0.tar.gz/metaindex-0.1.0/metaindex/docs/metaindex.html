<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>metaindex</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="metaindex">
<h1 class="title">metaindex</h1>
<h2 class="subtitle" id="document-search-by-metadata">document search by metadata</h2>

<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">doc/metaindex.rst</tt>, line 1)</p>
<p>Title overline too short.</p>
<pre class="literal-block">
======
metaindex
======
</pre>
</div>
<div class="section" id="synopsis">
<h1>Synopsis</h1>
<pre class="literal-block">
metaindex [-h] [-l loglevel] [-c configuration file] {add,find,index,remove,fs}
</pre>
</div>
<div class="section" id="description">
<h1>Description</h1>
<p>With metaindex you can find files on your disk based on their metadata, like
the title of a PDF, the keywords of an ebook, or the model of a camera that
a photo was taken with.</p>
<p>The following types of files are supported:</p>
<blockquote>
<ul class="simple">
<li>Images (anything that has EXIF, IPTC, or XMP information),</li>
<li>Audio (audio file formats that have ID3 header or similar),</li>
<li>Video (most video file formats have an ID3 header),</li>
<li>PDF,</li>
<li>ebooks (epub natively, calibre metadata files are understood, too).</li>
</ul>
</blockquote>
<p>User provided extra metadata is supported, if itâ€™s provided in the same
directory as the file and the metadata file is <tt class="docutils literal">.metadata.json</tt>. See
<a class="reference internal" href="#extra-metadata">Extra Metadata</a> below for more details.</p>
</div>
<div class="section" id="options">
<h1>Options</h1>
<p>General parameters are:</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-c</span> configuration file</tt></dt>
<dd>Use this configuration file instead of the one from the default
location.</dd>
<dt><tt class="docutils literal"><span class="pre">-h</span></tt></dt>
<dd>Show the help.</dd>
<dt><tt class="docutils literal"><span class="pre">-l</span> loglevel</tt></dt>
<dd>Set the level of details shown in logging. Your options are <tt class="docutils literal">fatal</tt>,
<tt class="docutils literal">error</tt>, <tt class="docutils literal">warning</tt>, <tt class="docutils literal">info</tt>, and <tt class="docutils literal">debug</tt>. Defaults to <tt class="docutils literal">warning</tt>.</dd>
</dl>
</blockquote>
<p>metaindex operates in one of the modes <tt class="docutils literal">add</tt>, <tt class="docutils literal">index</tt>, <tt class="docutils literal">find</tt> or
<tt class="docutils literal">remove</tt>. If you want to try the experimental filesystem mode, there is
also <tt class="docutils literal">fs</tt>.</p>
<div class="section" id="add">
<h2>Add</h2>
<p><tt class="docutils literal">Add</tt> allows you to add extra metadata to the given files:</p>
<pre class="literal-block">
metaindex add [-a] [-r] [-u] [-t tags] [--] [paths]
</pre>
<p>The extra metadat will be added to the existing metadata sidecar file in
the same directory that each file is located in. If no metadata sidecar
file exists yet, it will be created.</p>
<p>The options to this command are</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-t</span> tags</tt></dt>
<dd><p class="first">Tags to set. Have to be provided in the form of <tt class="docutils literal">tag:value</tt>. If you
want to set multiple tags, give one after the other, like this:</p>
<pre class="last literal-block">
metaindex add -t &quot;title:The Albatross&quot; author:Gumby -- paper1.pdf
</pre>
</dd>
<dt><tt class="docutils literal"><span class="pre">-a</span></tt></dt>
<dd>Apply changes only all files (and future files) of a directory.
If one of the paths is a directory this option will make sure that a
<tt class="docutils literal">*</tt> entry is added to the <tt class="docutils literal">.metadata.json</tt> file, effectively adding
the new tags to all current and all future files of this directory.</dd>
<dt><tt class="docutils literal"><span class="pre">-r</span></tt></dt>
<dd>Add the tags to all files in all subdirectories, too.
In combination with the <tt class="docutils literal"><span class="pre">-a</span></tt> option the new tags will be applied to
all subdirectories (and their subdirectories, and so on) for all paths
that are pointing to directories (creating a <tt class="docutils literal">**</tt> entry).</dd>
<dt><tt class="docutils literal"><span class="pre">-u</span></tt></dt>
<dd>Update the cache after adding all metadata. If you do not provide this
parameter, the cache will not receive the newly made changes and the
next search will not automatically show these added tags.</dd>
<dt><tt class="docutils literal">paths</tt></dt>
<dd>The paths to files or directories to add the tags to.
If a path is pointing to a directory, the metadata will be applied to
all files in the directory separately (creating an entry for each file
of the directory in the metadata sidecar file).</dd>
</dl>
</blockquote>
</div>
<div class="section" id="find">
<h2>Find</h2>
<p>This is the main operation used to search for files:</p>
<pre class="literal-block">
metaindex find [-l directory] [-f [-k]] [-t [tags]] [--] [search queries]
</pre>
<p>The options to this command are</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-t</span> [tags]</tt></dt>
<dd>Metadata tags that you wish to see per found file.</dd>
<dt><tt class="docutils literal"><span class="pre">-l</span> directory</tt></dt>
<dd>If this option is provided, metaindex will create this directory (or use
the existing directory only if it is empty) and create a symbolic link
to all files that matches this search.</dd>
<dt><tt class="docutils literal"><span class="pre">-f</span></tt></dt>
<dd>Enforce the use of <tt class="docutils literal"><span class="pre">-l</span></tt>â€™s <tt class="docutils literal">directory</tt>, even if it is not empty.
Still, metaindex will only work with that directory if it contains only
symbolic links (e.g. a previous search result)!
If <tt class="docutils literal"><span class="pre">-f</span></tt> is provided, all symbolic links in <tt class="docutils literal">directory</tt> will be
deleted and the links of this search will be put in place.</dd>
<dt><tt class="docutils literal"><span class="pre">-k</span></tt></dt>
<dd>When you use <tt class="docutils literal"><span class="pre">-l</span></tt> and <tt class="docutils literal"><span class="pre">-f</span></tt>, <tt class="docutils literal"><span class="pre">-k</span></tt> will keep all existing links in
the search directory. That means you can accumulate search results in
one directory.</dd>
<dt><tt class="docutils literal">search queries</tt></dt>
<dd>The terms to search for. If left empty, all files will be found. See
below in section <a class="reference internal" href="#search-query-syntax">Search Query Syntax</a> for the details on search
queries.
If the search query is only given as <tt class="docutils literal">-</tt>, metaindex will read the search
query from stdin.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="index">
<h2>Index</h2>
<p>This is the operation to index files and store that information in the
cache:</p>
<pre class="literal-block">
metaindex index [-C] [-r] [-p processes] [-i [paths]]
</pre>
<p>The options to this command are</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-C</span></tt></dt>
<dd>Clear the cache. If combined with other options, the flushing of the
cache will happen first.</dd>
<dt><tt class="docutils literal"><span class="pre">-m</span></tt></dt>
<dd>Remove missing files. When a file, that's in the index, can not be
found on disk anymore, it will be removed when this option is enabled.
By default this option is disabled.</dd>
<dt><tt class="docutils literal"><span class="pre">-i</span> [paths]</tt></dt>
<dd>Run the indexer on these paths. If no paths are provided, all paths in
the cache are revisited and checked for changes.
If <tt class="docutils literal">paths</tt> is <tt class="docutils literal">-</tt>, the list of files will be read from stdin, one
file per line.</dd>
<dt><tt class="docutils literal"><span class="pre">-p</span> processes</tt></dt>
<dd>By default metaindex will run as many indexer processes in parallel as
CPUs are available on the computer. This parameter allows you to define
how many indexers may be run at the same time.</dd>
<dt><tt class="docutils literal"><span class="pre">-r</span></tt></dt>
<dd>Run the indexer recursively. That means to visit all files in all
subdirectories of the paths in the <tt class="docutils literal"><span class="pre">-i</span></tt> parameter.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="remove">
<h2>Remove</h2>
<p>This operation can be used to remove metadata from files and
(sub)directories:</p>
<pre class="literal-block">
metaindex remove [-t tags] [-x] [-u] [-r] [--] [paths]
</pre>
<p>With this option it is possible to soft-remove metadata tags of files
without editing them directly. For example, if one of your epubs has an
inconvenient title in the metadata, you could run <tt class="docutils literal">metaindex remove <span class="pre">-t</span>
opf.title <span class="pre">--</span> <span class="pre">that-book.epub</span></tt>. It would not edit the epub, but add a field
in the sidecar file to not add the epubâ€™s title into the cache.</p>
<p>The options for this command are:</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-t</span> tags</tt></dt>
<dd><p class="first">The tags to remove by name (case-sensitive). Can be a synonym (see
<a class="reference internal" href="#synonyms">Synonyms</a> below). To remove several tags in the same command, just
add them after the <tt class="docutils literal"><span class="pre">-t</span></tt>, like this:</p>
<pre class="last literal-block">
metaindex remove -t opf.title opf.subject opf.summary -- that-book.epub
</pre>
</dd>
<dt><tt class="docutils literal"><span class="pre">-x</span></tt></dt>
<dd>Just remove all extra metadata that was provided in the user defined
sidecar files.</dd>
<dt><tt class="docutils literal"><span class="pre">-u</span></tt></dt>
<dd>Update cache after removing the tags. If you do not provide this
option, the cache will be outdated and you can still find the removed
tags.</dd>
<dt><tt class="docutils literal"><span class="pre">-r</span></tt></dt>
<dd>Remove tags recursively. That means the tags will also be removed from
all subdirectories (if you provide any directories in <tt class="docutils literal">paths</tt>).</dd>
<dt><tt class="docutils literal">paths</tt></dt>
<dd>The paths to the files and/or directories for which you want to remove
the given metadata tags.
If you provide a directory in the paths, the given tags will be removed
from all files in that directory.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="filesystem-fs">
<h2>Filesystem (fs)</h2>
<p>On Linux you can try the experimental feature of mounting a FuseFS that
will give you a structured access to your files through their metadata:</p>
<pre class="literal-block">
metaindex fs [command] [mount point]
</pre>
<p>The only supported command so far is <tt class="docutils literal">mount</tt>.</p>
<p>It is very experimental and not very useful, but at the same time will not
break any of your files as it only provides a read-only view on your tagged
files.</p>
</div>
</div>
<div class="section" id="files">
<h1>Files</h1>
<p>metaindex is controlled through a configuration file and caches metadata in a
cache file.</p>
<div class="section" id="cache-file">
<h2>Cache file</h2>
<p>The cache file is usually located in <tt class="docutils literal"><span class="pre">~/.cache/metaindex/index.db</span></tt>, but that
location is configurable.</p>
</div>
<div class="section" id="configuration-file">
<h2>Configuration file</h2>
<p>The configuration file is usually located in <tt class="docutils literal"><span class="pre">~/.config/metaindex.conf</span></tt>. An
example of the configuration file is provided in the <tt class="docutils literal">dist</tt> directory.
The syntax of the file is:</p>
<pre class="literal-block">
[Category]
option = value
</pre>
<p>There are several categories in the configuration file, the possible
options are described after this list:</p>
<blockquote>
<ul class="simple">
<li><tt class="docutils literal">[General]</tt>, general options</li>
<li><tt class="docutils literal">[Synonyms]</tt>, synonyms for tag names</li>
<li><tt class="docutils literal">[Include]</tt>, additional configuration files that have to be included</li>
</ul>
</blockquote>
<div class="section" id="general">
<h3>General</h3>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal">cache</tt></dt>
<dd>The location of the cache file. Defaults to
<tt class="docutils literal"><span class="pre">~/.cache/metaindex/index.db</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">recursive-extra-metadata</span></tt></dt>
<dd><p class="first">When looking for sidecar metadata files (see <a class="reference internal" href="#extra-metadata">Extra Metadata</a>), also
look in all parent directories for metadata. Defaults to <tt class="docutils literal">yes</tt>.</p>
<p class="last">This is useful when the file is <tt class="docutils literal">collection/part/file.jpg</tt> but the
metadata file is <tt class="docutils literal"><span class="pre">collection/.metadata.json</span></tt> (and in this metadata
file the reference is made to <tt class="docutils literal">part/file.jpg</tt>).</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">collection-metadata</span></tt></dt>
<dd><p class="first">Some sidecar files can define metadata that applies to the entire
collection of files in that directory. This options controls what
files may define that type of metadata.
Based on the available metadata storage modules (e.g. JSON, and OPF)
these names are extended by the corresponding file extensions.
Defaults to <tt class="docutils literal">.metadata, metadata</tt>.</p>
<p>That means, with JSON and OPF enabled, that the metadata files
<tt class="docutils literal">.metadata.json, .metadata.opf, metadata.json, metadata.opf</tt> are
considered.</p>
<p class="last">See below in <a class="reference internal" href="#extra-metadata">Extra Metadata</a> for more details.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">ignore-dirs</span></tt></dt>
<dd>What folders (and their subfolders) to ignore entirely. One folder per
line. Defaults to <tt class="docutils literal">.git</tt> and <tt class="docutils literal">System Volume Information</tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">ignore-tags</span></tt></dt>
<dd>What (automatically extracted) tags to not add to the cache and thus
prevent them being searchable. Comma-separated list of the tags.
Defaults to: <tt class="docutils literal">Exif.Image.StripByteCounts, Exif.Image.StripOffsets</tt>.</dd>
<dt><tt class="docutils literal">mimetypes</tt></dt>
<dd>If you have additional mimetypes that you would like metaindex to know,
this is the option you can use to point to additional mimetype files.
To add multiple files, separate them by a newline. No matter what files
you provide here, you system's mimetype file will always be used.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="synonyms">
<h3>Synonyms</h3>
<p>Some metadata fields have less convenient names than others, but might
semantically be the same. For example, <tt class="docutils literal">Xmp.xmp.CreatorTool</tt> and
<tt class="docutils literal">pdf.Creator</tt> both mean &quot;The program that was used to create this file&quot;.</p>
<p>For convenience it is possible to define synonyms, so you only have to
search for <tt class="docutils literal">author</tt> when you mean to search for <tt class="docutils literal">id3.artist</tt>,
<tt class="docutils literal">pdf.Author</tt>, or <tt class="docutils literal">Exif.Image.Artist</tt>.</p>
<p>The section <tt class="docutils literal">[Synonyms]</tt> in the configuration file is the place to define
these synonyms. Here are the defaults, that you donâ€™t have to set up:</p>
<pre class="literal-block">
[Synonyms]
author = extra.author, extra.artist, id3.artist, pdf.Author, Exif.Image.Artist
title = extra.title, id3.title, pdf.Title, Xmp.dc.title, extra.opf.title
tags = extra.tags, pdf.Keywords, pdf.Categories, Xmp.dc.subject, extra.subject, pdf.Subject, opf.subject, extra.opf.subject
language = opf.language, pdf.Language, Xmp.dc.language, extra.language, extra.opf.language
series = extra.series
series_index = extra.series_index
</pre>
</div>
<div class="section" id="include">
<h3>Include</h3>
<p>You can include additional configuration files (for example to split up
your configuration into multiple files).</p>
<p>All the <tt class="docutils literal">name = path</tt> entries in the <tt class="docutils literal">[Include]</tt> section will be loaded
in the alphabetical order of the names.</p>
<p>In this example <tt class="docutils literal"><span class="pre">~/.metaindex.conf</span></tt> will be loaded and then
<tt class="docutils literal">/tmp/metaindex.conf</tt>. Both of course only after the main configuration file:</p>
<pre class="literal-block">
[Include]
xtra = /tmp/metaindex.conf
extra = ~/.metaindex.conf
</pre>
<p>Additional <tt class="docutils literal">[Includes]</tt> in these included configuration files are ignored
though.</p>
</div>
</div>
</div>
<div class="section" id="search-query-syntax">
<h1>Search Query Syntax</h1>
<p>If the search term only contains a simple word, like <tt class="docutils literal">albatross</tt>, all
files will be found that contain this word in any metadata field.</p>
<p>To search for a phrase containing spaces, you have to enclose the phrase in
blockquotes or single quotes, like <tt class="docutils literal">&quot;albatross flavour&quot;</tt>.</p>
<p>To search for &quot;albatross&quot; in a specific metadata field, like in the title,
you have to search for <tt class="docutils literal">title:albatross</tt>. Again, the phrase search
requires quotes: <tt class="docutils literal"><span class="pre">title:&quot;albatross</span> flavour&quot;</tt>.</p>
<p>You can search files by the existance of a metadata tag by adding a <tt class="docutils literal">?</tt>
after the name of the metadata tag. For example, to find all files that
have the <tt class="docutils literal">resolution</tt> metadata tag: <tt class="docutils literal">resolution?</tt>.</p>
<p>When the search includes the tag name, you have to provide the full
case-sensitive name of the tag. <tt class="docutils literal">artist</tt> and <tt class="docutils literal">Artist</tt> are very
different tag names and just searching for <tt class="docutils literal">artist:tim</tt> when you mean to
search for <tt class="docutils literal">albumartist</tt> will not result in the same search results.</p>
<p>Have a look at the <a class="reference internal" href="#synonyms">Synonyms</a> feature to find out how to search
conveniently for more complex tag names.</p>
<p>When searching for multiple terms, you can choose to connect the terms with
<tt class="docutils literal">and</tt> or <tt class="docutils literal">or</tt>. <tt class="docutils literal">and</tt> is the default if none is provided, so these two
search queries, to find all photos made with a Canon camera and with a
width of 1024 pixels, are the same:</p>
<pre class="literal-block">
resolution:1024x Exif.Image.Model:canon

resolution:1024x and Exif.Image.Model:canon
</pre>
<p>To search for all pictures that are made with a Canon camera or have that
width, you have to use <tt class="docutils literal">or</tt>:</p>
<pre class="literal-block">
resolution:1024x or Exif.Image.Model:canon
</pre>
<div class="section" id="metadata-tags">
<h2>Metadata tags</h2>
<p>These metadata tags are always available:</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal">last_accessed</tt></dt>
<dd>A timestamp when the file was accessed the last time (if the OS
supports it).</dd>
<dt><tt class="docutils literal">last_modified</tt></dt>
<dd>A timestamp when the file was modified the last time (if the OS
supports it).</dd>
<dt><tt class="docutils literal">filename</tt></dt>
<dd>The name of the file on disk including extensions.</dd>
<dt><tt class="docutils literal">size</tt></dt>
<dd>The file size in bytes.</dd>
<dt><tt class="docutils literal">mimetype</tt></dt>
<dd>The mimetype of the file, if it could be detected.</dd>
</dl>
</blockquote>
</div>
</div>
<div class="section" id="extra-metadata">
<h1>Extra Metadata</h1>
<p>Not all filetypes support metadata (plain text files, for example) and
using extra files on the side (but in the same directory as the file to be
tagged) is used. These files on the side are called &quot;sidecar files&quot;.</p>
<p>Sidecar files are expected to have the same filename as the file that they
are describing, but with a different extension, based on how the
description is provided. So, if you want to add additional metadata to your
<tt class="docutils literal">moose.jpg</tt>, you could create a <tt class="docutils literal">moose.json</tt> sidecar file or a
<tt class="docutils literal">moose.opf</tt> file.</p>
<p>All metadata provided by extra sidecar files is cached with the <tt class="docutils literal">extra.</tt>
prefix. For example, if your metadata file tags a file with <tt class="docutils literal">title</tt>, you
can search for it by looking for <tt class="docutils literal">extra.title</tt>.</p>
<p>metaindex supports sidecar files in JSON format like this when the file is
used for several files:</p>
<pre class="literal-block">
{
 &quot;file.ext&quot;: {
  &quot;title&quot;: &quot;An example file&quot;,
  &quot;authors&quot;: [&quot;dr Gumby&quot;, &quot;The Bishop&quot;],
  &quot;Xmp.dc.title&quot;: null
 }
}
</pre>
<p>Or like this if the JSON file is used for only one file:</p>
<pre class="literal-block">
{
  &quot;title&quot;: &quot;A long story&quot;,
  &quot;date&quot;: 2012-05-01
}
</pre>
<p>The special value of <tt class="docutils literal">null</tt> allows you to ignore a metadata tag from that
file, i.e. if that file has the <tt class="docutils literal">Xmp.dc.title</tt> tag, it will be ignored.</p>
<p>Calibre style sidecar files, usually called <tt class="docutils literal">metadata.opf</tt> are also
supported.</p>
<div class="section" id="collection-metadata">
<h2>Collection Metadata</h2>
<p>Sometimes all files in a directory should receive the same set of metadata.
This is called &quot;Collection metadata&quot; and can be accomplished in JSON
sidecar files (like <tt class="docutils literal">.metadata.json</tt>) by adding an entry <tt class="docutils literal">&quot;*&quot;</tt>, like
this:</p>
<pre class="literal-block">
{
  &quot;*&quot;: {
    &quot;tags&quot;: [&quot;tag1&quot;, &quot;tag2&quot;]
  },
  &quot;file.tif&quot;: {
    &quot;tags&quot;: [&quot;tag3&quot;]
  }
}
</pre>
<p>Suppose you have this <tt class="docutils literal">.metadata.json</tt> in a directory with two files,
<tt class="docutils literal">file.tif</tt> and <tt class="docutils literal">other.csv</tt>. Both files will receive the tags <tt class="docutils literal">tag1</tt>
and <tt class="docutils literal">tag2</tt>, but only <tt class="docutils literal">file.tif</tt> will have all three tags.</p>
<p>For collection metadata to work properly, the <a class="reference internal" href="#general">General</a> option
<tt class="docutils literal"><span class="pre">collection-metadata</span></tt> must be set to the names of sidecar files that are
allowed to define collection metadata.</p>
<p>By default files like <tt class="docutils literal">.metadata.json</tt>, and <tt class="docutils literal">metadata.opf</tt>
are expected to contain extra metadata (see <a class="reference internal" href="#general">General</a> options above).
If your metadata files are called
differently, for example <tt class="docutils literal">meta.json</tt> and <tt class="docutils literal">.extra.json</tt>, you can
configure that in the metaindex configuration file:</p>
<pre class="literal-block">
[General]
collection-metadata = meta, .extra
</pre>
<p>The filenames listed in <tt class="docutils literal"><span class="pre">collection-metadata</span></tt> will be excluded from indexing,
so they will not show up when you search for them (e.g. via <tt class="docutils literal">metaindex find
filename:metadata</tt>)!</p>
</div>
<div class="section" id="recursive-collection-metadata">
<h2>Recursive Collection Metadata</h2>
<p>If you want to apply the collection metadata not only to the files of the
sidecarâ€™s directory, but also in all subdirectories, you can use the
&quot;recursive collection metadata&quot; <tt class="docutils literal"><span class="pre">&quot;**&quot;</span></tt>.</p>
<p>This is useful if you already have your data structured in directories, for
example in this way: <tt class="docutils literal">pictures/nature/animals/duck.jpg</tt>.</p>
<p>Here you could add a <tt class="docutils literal">.metadata.json</tt> file in the <tt class="docutils literal">nature</tt> directory
with this recursive directive:</p>
<pre class="literal-block">
{
  &quot;**&quot;: {
    &quot;tags&quot;: [&quot;nature&quot;]
  }
}
</pre>
<p>Now not only the files in <tt class="docutils literal">nature</tt> are tagged as <tt class="docutils literal">nature</tt>, but also
all files in <tt class="docutils literal">animals</tt>.</p>
<p>You can disable this functionality entirely by setting the <a class="reference internal" href="#general">General</a>
option <tt class="docutils literal"><span class="pre">recursive-collection-metadata</span></tt> to an empty string:</p>
<pre class="literal-block">
[General]
recursive-collection-metadata =
</pre>
<p><strong>Caveat</strong>: you can not defined both, a recursive and a non-recursive set
of collection metadata in the same directory:</p>
<pre class="literal-block">
{
  &quot;*&quot;: {
    &quot;description&quot;: &quot;BROKEN EXAMPLE: this does not work!&quot;
  },
  &quot;**&quot;: {
    &quot;title&quot;: &quot;BROKEN EXAMPLE! 'title' AND 'description' will be applied to all
    subdirectories!&quot;
  }
}
</pre>
</div>
</div>
<div class="section" id="usage-examples">
<h1>Usage Examples</h1>
<div class="section" id="index-some-directories">
<h2>Index some directories</h2>
<p>To index you <tt class="docutils literal">Documents</tt> and <tt class="docutils literal">Pictures</tt> folder recursively:</p>
<pre class="literal-block">
metaindex index -r -i ~/Documents ~/Pictures
</pre>
</div>
<div class="section" id="reindex-all-files">
<h2>Reindex all files</h2>
<p>To only update the metadata from all known files:</p>
<pre class="literal-block">
metaindex index -i
</pre>
</div>
<div class="section" id="find-all-files">
<h2>Find all files</h2>
<p>List all files that are in cache:</p>
<pre class="literal-block">
metaindex find
</pre>
</div>
<div class="section" id="find-file-by-mimetype">
<h2>Find file by mimetype</h2>
<p>Searching for all <tt class="docutils literal">image/*</tt> mimetypes can be accomplished by this:</p>
<pre class="literal-block">
metaindex find mimetype:^image/
</pre>
</div>
<div class="section" id="listing-metadata">
<h2>Listing metadata</h2>
<p>To list all metadata tags and values of all odt files:</p>
<pre class="literal-block">
metaindex find -t -- &quot;filename:odt$&quot;
</pre>
<p>List the resolutions of all files that have the <tt class="docutils literal">resolution</tt> metadata tag:</p>
<pre class="literal-block">
metaindex find -t resolution -- &quot;resolution?&quot;
</pre>
</div>
</div>
<div class="section" id="bugs">
<h1>Bugs</h1>
<p>Surely. Please report anything that you find at
<a class="reference external" href="https://github.com/vonshednob/metaindex">https://github.com/vonshednob/metaindex</a> or via email to the authors.</p>
</div>
</div>
</body>
</html>
