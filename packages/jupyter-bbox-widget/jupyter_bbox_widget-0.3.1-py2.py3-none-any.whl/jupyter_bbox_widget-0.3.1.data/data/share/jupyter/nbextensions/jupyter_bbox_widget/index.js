define(["@jupyter-widgets/base"],(e=>(()=>{"use strict";var t={306:e=>{e.exports=JSON.parse('{"name":"jupyter-bbox-widget","version":"0.3.1","description":"A Jupyter widget for annotating images with bounding boxes","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js"],"homepage":"https://github.com/gereleth/jupyter-bbox-widget","bugs":{"url":"https://github.com/gereleth/jupyter-bbox-widget/issues"},"license":"BSD-3-Clause","author":{"name":"gereleth","email":"daria.voznyak@gmail.com"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/gereleth/jupyter-bbox-widget"},"scripts":{"build":"npm run build:nbextension","build:labextension":"npm run clean:labextension && mkdirp jupyter_bbox_widget/labextension && cd jupyter_bbox_widget/labextension && npm pack ../..","build:nbextension":"webpack --mode=production","build:all":"npm run build:labextension && npm run build:nbextension","clean":"npm run clean:lib && npm run clean:nbextension","clean:lib":"rimraf lib","clean:labextension":"rimraf jupyter_bbox_widget/labextension","clean:nbextension":"rimraf jupyter_bbox_widget/nbextension/static/index.js","lint":"eslint . --ext .ts,.tsx --fix","lint:check":"eslint . --ext .ts,.tsx","prepack":"npm run build","watch":"npm-run-all -p watch:*","watch:nbextension":"webpack --watch","dev":"webpack-cli serve --inline --hot --progress --content-base ./mock --open -o ./mock"},"dependencies":{"@jupyter-widgets/base":"^4.0.0"},"devDependencies":{"@phosphor/application":"^1.6.0","@phosphor/widgets":"^1.6.0","@tsconfig/svelte":"^1.0.10","@types/node":"^10.11.6","@types/webpack-env":"^1.13.6","@typescript-eslint/eslint-plugin":"^3.6.0","@typescript-eslint/parser":"^3.6.0","@webpack-cli/serve":"^1.2.2","acorn":"^7.2.0","css-loader":"^5.2.6","eslint":"^7.4.0","eslint-config-prettier":"^6.11.0","eslint-plugin-prettier":"^3.1.4","fs-extra":"^7.0.0","mkdirp":"^0.5.1","npm-run-all":"^4.1.3","prettier":"^2.0.5","rimraf":"^2.6.2","source-map-loader":"^0.2.4","style-loader":"^1.0.0","svelte":"^3.0.0","svelte-loader":"2.13.3","svelte-preprocess":"^4.7.0","ts-loader":"^5.2.1","typescript":"^4.2.4","webpack":"^5.20.1","webpack-cli":"^4.4.0","webpack-dev-server":"^3.11.2"},"jupyterlab":{"extension":"lib/plugin"}}')},612:t=>{t.exports=e}},n={};function o(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{o.r(s),o.d(s,{BBoxModel:()=>We,BBoxView:()=>Te,MODULE_NAME:()=>n,MODULE_VERSION:()=>t});const e=o(306),t=e.version,n=e.name;var i=o(612);function l(){}const r=e=>e;function c(e){return e()}function u(){return Object.create(null)}function a(e){e.forEach(c)}function d(e){return"function"==typeof e}function p(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function f(e){return 0===Object.keys(e).length}function h(e,t,n){e.$$.on_destroy.push(function(e,...t){if(null==e)return l;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}(t,n))}function b(e){return null==e?"":e}function g(e,t,n=t){return e.set(n),t}const m="undefined"!=typeof window;let y=m?()=>window.performance.now():()=>Date.now(),x=m?e=>requestAnimationFrame(e):l;const v=new Set;function w(e){v.forEach((t=>{t.c(e)||(v.delete(t),t.f())})),0!==v.size&&x(w)}function $(e,t){e.appendChild(t)}function k(e,t,n){e.insertBefore(t,n||null)}function _(e){e.parentNode.removeChild(e)}function E(e){return document.createElement(e)}function M(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function j(e){return document.createTextNode(e)}function q(){return j(" ")}function C(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function S(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function O(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function A(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}let z;function D(){if(void 0===z){z=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(e){z=!0}}return z}function B(e,t,n){e.classList[n?"add":"remove"](t)}function P(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const K=new Set;let N,I=0;function W(e,t,n,o,s,i,l,r=0){const c=16.666/o;let u="{\n";for(let e=0;e<=1;e+=c){const o=t+(n-t)*i(e);u+=100*e+`%{${l(o,1-o)}}\n`}const a=u+`100% {${l(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(a)}_${r}`,p=e.ownerDocument;K.add(p);const f=p.__svelte_stylesheet||(p.__svelte_stylesheet=p.head.appendChild(E("style")).sheet),h=p.__svelte_rules||(p.__svelte_rules={});h[d]||(h[d]=!0,f.insertRule(`@keyframes ${d} ${a}`,f.cssRules.length));const b=e.style.animation||"";return e.style.animation=`${b?`${b}, `:""}${d} ${o}ms linear ${s}ms 1 both`,I+=1,d}function T(e){N=e}function X(){if(!N)throw new Error("Function called outside component initialization");return N}const Y=[],R=[],L=[],F=[],H=Promise.resolve();let V=!1;function J(e){L.push(e)}function U(e){F.push(e)}let G=!1;const Q=new Set;function Z(){if(!G){G=!0;do{for(let e=0;e<Y.length;e+=1){const t=Y[e];T(t),ee(t.$$)}for(T(null),Y.length=0;R.length;)R.pop()();for(let e=0;e<L.length;e+=1){const t=L[e];Q.has(t)||(Q.add(t),t())}L.length=0}while(Y.length);for(;F.length;)F.pop()();V=!1,G=!1,Q.clear()}}function ee(e){if(null!==e.fragment){e.update(),a(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(J)}}let te;function ne(e,t,n){e.dispatchEvent(P(`${t?"intro":"outro"}${n}`))}const oe=new Set;let se;function ie(){se={r:0,c:[],p:se}}function le(){se.r||a(se.c),se=se.p}function re(e,t){e&&e.i&&(oe.delete(e),e.i(t))}function ce(e,t,n,o){if(e&&e.o){if(oe.has(e))return;oe.add(e),se.c.push((()=>{oe.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const ue={duration:0};function ae(e,t,n,o){let s=t(e,n),i=o?0:1,c=null,u=null,p=null;function f(){p&&function(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),s=n.length-o.length;s&&(e.style.animation=o.join(", "),I-=s,I||x((()=>{I||(K.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),K.clear())})))}(e,p)}function h(e,t){const n=e.b-i;return t*=Math.abs(n),{a:i,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function b(t){const{delay:n=0,duration:o=300,easing:d=r,tick:b=l,css:g}=s||ue,m={start:y()+n,b:t};t||(m.group=se,se.r+=1),c||u?u=m:(g&&(f(),p=W(e,i,t,o,n,d,g)),t&&b(0,1),c=h(m,o),J((()=>ne(e,t,"start"))),function(e){let t;0===v.size&&x(w),new Promise((n=>{v.add(t={c:e,f:n})}))}((t=>{if(u&&t>u.start&&(c=h(u,o),u=null,ne(e,c.b,"start"),g&&(f(),p=W(e,i,c.b,c.duration,0,d,s.css))),c)if(t>=c.end)b(i=c.b,1-i),ne(e,c.b,"end"),u||(c.b?f():--c.group.r||a(c.group.c)),c=null;else if(t>=c.start){const e=t-c.start;i=c.a+c.d*d(e/c.duration),b(i,1-i)}return!(!c&&!u)})))}return{run(e){d(s)?(te||(te=Promise.resolve(),te.then((()=>{te=null}))),te).then((()=>{s=s(),b(e)})):b(e)},end(){f(),c=u=null}}}const de="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function pe(e,t){ce(e,1,1,(()=>{t.delete(e.key)}))}let fe;function he(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function be(e){e&&e.c()}function ge(e,t,n,o){const{fragment:s,on_mount:i,on_destroy:l,after_update:r}=e.$$;s&&s.m(t,n),o||J((()=>{const t=i.map(c).filter(d);l?l.push(...t):a(t),e.$$.on_mount=[]})),r.forEach(J)}function me(e,t){const n=e.$$;null!==n.fragment&&(a(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ye(e,t,n,o,s,i,r=[-1]){const c=N;T(e);const d=e.$$={fragment:null,ctx:null,props:i,update:l,not_equal:s,bound:u(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:t.context||[]),callbacks:u(),dirty:r,skip_bound:!1};let p=!1;if(d.ctx=n?n(e,t.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return d.ctx&&s(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),p&&function(e,t){-1===e.$$.dirty[0]&&(Y.push(e),V||(V=!0,H.then(Z)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],d.update(),p=!0,a(d.before_update),d.fragment=!!o&&o(d.ctx),t.target){if(t.hydrate){const e=(f=t.target,Array.from(f.childNodes));d.fragment&&d.fragment.l(e),e.forEach(_)}else d.fragment&&d.fragment.c();t.intro&&re(e.$$.fragment),ge(e,t.target,t.anchor,t.customElement),Z()}var f;T(c)}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(fe=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(c).filter(d);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){a(this.$$.on_disconnect)}$destroy(){me(this,1),this.$destroy=l}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!f(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class xe{$destroy(){me(this,1),this.$destroy=l}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!f(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ve(e){let t,n,o,s,i,l,r,c,u,d,p,f,h,b,g,m,y,x,v,w,E,O,z,D,B,P,K,N,I,W,T,X,Y,R,L,F,H,V,J,U,G,Q,Z,ee,te,ne,oe,se,ie,le;return{c(){t=M("line"),l=q(),r=M("line"),f=q(),h=M("line"),x=q(),v=M("line"),D=q(),B=M("circle"),I=q(),W=M("circle"),R=q(),L=M("circle"),J=q(),U=M("circle"),ee=q(),te=M("text"),ne=j("ðŸ—™"),S(t,"x1",n=e[2]*e[6]),S(t,"y1",o=e[3]*e[7]),S(t,"x2",s=(e[2]+e[0])*e[6]),S(t,"y2",i=e[3]*e[7]),A(t,"stroke-width","10px"),A(t,"stroke","black"),A(t,"stroke-opacity","0"),S(t,"class","top svelte-1keccdr"),S(r,"x1",c=e[2]*e[6]),S(r,"y1",u=(e[3]+e[1])*e[7]),S(r,"x2",d=(e[2]+e[0])*e[6]),S(r,"y2",p=(e[3]+e[1])*e[7]),A(r,"stroke-width","10px"),A(r,"stroke","black"),A(r,"stroke-opacity","0"),S(r,"class","bottom svelte-1keccdr"),S(h,"x1",b=e[2]*e[6]),S(h,"y1",g=e[3]*e[7]),S(h,"x2",m=e[2]*e[6]),S(h,"y2",y=(e[3]+e[1])*e[7]),A(h,"stroke-width","10px"),A(h,"stroke","black"),A(h,"stroke-opacity","0"),S(h,"class","left svelte-1keccdr"),S(v,"x1",w=(e[2]+e[0])*e[6]),S(v,"y1",E=e[3]*e[7]),S(v,"x2",O=(e[2]+e[0])*e[6]),S(v,"y2",z=(e[3]+e[1])*e[7]),A(v,"stroke-width","10px"),A(v,"stroke","black"),A(v,"stroke-opacity","0"),S(v,"class","right svelte-1keccdr"),S(B,"cx",P=e[2]*e[6]),S(B,"cy",K=e[3]*e[7]),S(B,"r",N=6),S(B,"fill-opacity","0"),S(B,"class","top-left svelte-1keccdr"),S(W,"cx",T=(e[2]+e[0])*e[6]),S(W,"cy",X=e[3]*e[7]),S(W,"r",Y=6),S(W,"fill-opacity","0"),S(W,"class","top-right svelte-1keccdr"),S(L,"cx",F=e[2]*e[6]),S(L,"cy",H=(e[3]+e[1])*e[7]),S(L,"r",V=6),S(L,"fill-opacity","0"),S(L,"class","bottom-left svelte-1keccdr"),S(U,"cx",G=(e[2]+e[0])*e[6]),S(U,"cy",Q=(e[3]+e[1])*e[7]),S(U,"r",Z=6),S(U,"fill-opacity","0"),S(U,"class","bottom-right svelte-1keccdr"),S(te,"x",oe=(e[2]+e[0])*e[6]-13),S(te,"y",se=e[3]*e[7]-4),S(te,"fill",e[10]),S(te,"class","clickable svelte-1keccdr")},m(n,o){k(n,t,o),k(n,l,o),k(n,r,o),k(n,f,o),k(n,h,o),k(n,x,o),k(n,v,o),k(n,D,o),k(n,B,o),k(n,I,o),k(n,W,o),k(n,R,o),k(n,L,o),k(n,J,o),k(n,U,o),k(n,ee,o),k(n,te,o),$(te,ne),ie||(le=[C(t,"mousedown",e[18]),C(r,"mousedown",e[19]),C(h,"mousedown",e[20]),C(v,"mousedown",e[21]),C(B,"mousedown",e[22]),C(W,"mousedown",e[23]),C(L,"mousedown",e[24]),C(U,"mousedown",e[25]),C(te,"mousedown",e[13])],ie=!0)},p(e,l){68&l[0]&&n!==(n=e[2]*e[6])&&S(t,"x1",n),136&l[0]&&o!==(o=e[3]*e[7])&&S(t,"y1",o),69&l[0]&&s!==(s=(e[2]+e[0])*e[6])&&S(t,"x2",s),136&l[0]&&i!==(i=e[3]*e[7])&&S(t,"y2",i),68&l[0]&&c!==(c=e[2]*e[6])&&S(r,"x1",c),138&l[0]&&u!==(u=(e[3]+e[1])*e[7])&&S(r,"y1",u),69&l[0]&&d!==(d=(e[2]+e[0])*e[6])&&S(r,"x2",d),138&l[0]&&p!==(p=(e[3]+e[1])*e[7])&&S(r,"y2",p),68&l[0]&&b!==(b=e[2]*e[6])&&S(h,"x1",b),136&l[0]&&g!==(g=e[3]*e[7])&&S(h,"y1",g),68&l[0]&&m!==(m=e[2]*e[6])&&S(h,"x2",m),138&l[0]&&y!==(y=(e[3]+e[1])*e[7])&&S(h,"y2",y),69&l[0]&&w!==(w=(e[2]+e[0])*e[6])&&S(v,"x1",w),136&l[0]&&E!==(E=e[3]*e[7])&&S(v,"y1",E),69&l[0]&&O!==(O=(e[2]+e[0])*e[6])&&S(v,"x2",O),138&l[0]&&z!==(z=(e[3]+e[1])*e[7])&&S(v,"y2",z),68&l[0]&&P!==(P=e[2]*e[6])&&S(B,"cx",P),136&l[0]&&K!==(K=e[3]*e[7])&&S(B,"cy",K),69&l[0]&&T!==(T=(e[2]+e[0])*e[6])&&S(W,"cx",T),136&l[0]&&X!==(X=e[3]*e[7])&&S(W,"cy",X),68&l[0]&&F!==(F=e[2]*e[6])&&S(L,"cx",F),138&l[0]&&H!==(H=(e[3]+e[1])*e[7])&&S(L,"cy",H),69&l[0]&&G!==(G=(e[2]+e[0])*e[6])&&S(U,"cx",G),138&l[0]&&Q!==(Q=(e[3]+e[1])*e[7])&&S(U,"cy",Q),69&l[0]&&oe!==(oe=(e[2]+e[0])*e[6]-13)&&S(te,"x",oe),136&l[0]&&se!==(se=e[3]*e[7]-4)&&S(te,"y",se),1024&l[0]&&S(te,"fill",e[10])},d(e){e&&_(t),e&&_(l),e&&_(r),e&&_(f),e&&_(h),e&&_(x),e&&_(v),e&&_(D),e&&_(B),e&&_(I),e&&_(W),e&&_(R),e&&_(L),e&&_(J),e&&_(U),e&&_(ee),e&&_(te),ie=!1,a(le)}}}function we(e){let t,n,o,s,i,r,c,u,d,p,f,h,b,g,m,y,x,v,w,E=!e[9]&&ve(e);return{c(){t=M("text"),n=j(e[4]),i=q(),r=M("text"),c=j(e[4]),p=q(),f=M("rect"),y=q(),E&&E.c(),x=j(""),S(t,"filter","url(#bg-text)"),S(t,"fill","black"),S(t,"x",o=e[2]*e[6]),S(t,"y",s=e[3]*e[7]-4),S(r,"x",u=e[2]*e[6]),S(r,"y",d=e[3]*e[7]-4),S(r,"fill","#333"),S(r,"class","svelte-1keccdr"),B(r,"clickable",!e[9]),S(f,"width",h=e[0]*e[6]),S(f,"height",b=e[1]*e[7]),A(f,"fill-opacity",e[5]),A(f,"stroke-width",e[8]?3:2),A(f,"stroke",e[10]),S(f,"shape-rendering","crispEdges"),S(f,"x",g=e[2]*e[6]),S(f,"y",m=e[3]*e[7]),S(f,"class","svelte-1keccdr"),B(f,"movable",!e[9])},m(o,s){k(o,t,s),$(t,n),k(o,i,s),k(o,r,s),$(r,c),k(o,p,s),k(o,f,s),k(o,y,s),E&&E.m(o,s),k(o,x,s),v||(w=[C(r,"mousedown",e[14]),C(f,"mousedown",e[11])],v=!0)},p(e,i){16&i[0]&&O(n,e[4]),68&i[0]&&o!==(o=e[2]*e[6])&&S(t,"x",o),136&i[0]&&s!==(s=e[3]*e[7]-4)&&S(t,"y",s),16&i[0]&&O(c,e[4]),68&i[0]&&u!==(u=e[2]*e[6])&&S(r,"x",u),136&i[0]&&d!==(d=e[3]*e[7]-4)&&S(r,"y",d),512&i[0]&&B(r,"clickable",!e[9]),65&i[0]&&h!==(h=e[0]*e[6])&&S(f,"width",h),130&i[0]&&b!==(b=e[1]*e[7])&&S(f,"height",b),32&i[0]&&A(f,"fill-opacity",e[5]),256&i[0]&&A(f,"stroke-width",e[8]?3:2),1024&i[0]&&A(f,"stroke",e[10]),68&i[0]&&g!==(g=e[2]*e[6])&&S(f,"x",g),136&i[0]&&m!==(m=e[3]*e[7])&&S(f,"y",m),512&i[0]&&B(f,"movable",!e[9]),e[9]?E&&(E.d(1),E=null):E?E.p(e,i):(E=ve(e),E.c(),E.m(x.parentNode,x))},i:l,o:l,d(e){e&&_(t),e&&_(i),e&&_(r),e&&_(p),e&&_(f),e&&_(y),E&&E.d(e),e&&_(x),v=!1,a(w)}}}function $e(e,t,n){let{width:o=0}=t,{height:s=0}=t,{x:i=0}=t,{y:l=0}=t,{label:r=""}=t,{colors:c=["red"]}=t,{classes:u=[]}=t,{opacity:a=0}=t,{toImageCoordinates:d}=t,{scaleX:p=1}=t,{scaleY:f=1}=t,{isActive:h=!1}=t,{view_only:b=!1}=t;const g=function(){const e=X();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const s=P(t,n);o.slice().forEach((t=>{t.call(e,s)}))}}}();let m=0,y=0,x=0,v=0,w=!1,$=!1,k="rgb(255,64,64)";function _(e){e.stopPropagation(),e.preventDefault();const t=(e.clientX-m)/p,o=(e.clientY-y)/f;n(2,i=Math.round(x+t)),n(3,l=Math.round(v+o))}function E(e,t){0===e.button&&(e.stopPropagation(),w=!1,$=!1,t.includes("top")?($=!0,v=l+s):t.includes("bottom")&&($=!0,v=l),t.includes("left")?(w=!0,x=i+o):t.includes("right")&&(w=!0,x=i),g("move",M))}function M(e){e.stopPropagation(),e.preventDefault();const t=d(e),r=Math.round(t.x),c=Math.round(t.y);w&&(n(2,i=Math.min(x,r)),n(0,o=Math.max(x,r)-i)),$&&(n(3,l=Math.min(v,c)),n(1,s=Math.max(v,c)-l))}var j;return j=()=>{x=i,v=l,m=i,y=l,w=!0,$=!0,g("create",M)},X().$$.on_mount.push(j),e.$$set=e=>{"width"in e&&n(0,o=e.width),"height"in e&&n(1,s=e.height),"x"in e&&n(2,i=e.x),"y"in e&&n(3,l=e.y),"label"in e&&n(4,r=e.label),"colors"in e&&n(15,c=e.colors),"classes"in e&&n(16,u=e.classes),"opacity"in e&&n(5,a=e.opacity),"toImageCoordinates"in e&&n(17,d=e.toImageCoordinates),"scaleX"in e&&n(6,p=e.scaleX),"scaleY"in e&&n(7,f=e.scaleY),"isActive"in e&&n(8,h=e.isActive),"view_only"in e&&n(9,b=e.view_only)},e.$$.update=()=>{98320&e.$$.dirty[0]&&n(10,k=c[Math.max(0,u.indexOf(r)%c.length)])},[o,s,i,l,r,a,p,f,h,b,k,function(e){0===e.button&&(e.stopPropagation(),m=e.clientX,y=e.clientY,x=i,v=l,g("move",b?null:_))},E,function(e){0===e.button&&(e.stopPropagation(),g("remove"))},function(e){b||0===e.button&&(e.stopPropagation(),g("label"))},c,u,d,e=>E(e,"top"),e=>E(e,"bottom"),e=>E(e,"left"),e=>E(e,"right"),e=>E(e,"top-left"),e=>E(e,"top-right"),e=>E(e,"bottom-left"),e=>E(e,"bottom-right")]}const ke=class extends xe{constructor(e){var t;super(),document.getElementById("svelte-1keccdr-style")||((t=E("style")).id="svelte-1keccdr-style",t.textContent="rect.movable.svelte-1keccdr{cursor:move}.top.svelte-1keccdr,.bottom.svelte-1keccdr{cursor:row-resize}.left.svelte-1keccdr,.right.svelte-1keccdr{cursor:col-resize}text.clickable.svelte-1keccdr{cursor:pointer}.top-left.svelte-1keccdr{cursor:nw-resize}.top-right.svelte-1keccdr{cursor:ne-resize}.bottom-left.svelte-1keccdr{cursor:sw-resize}.bottom-right.svelte-1keccdr{cursor:se-resize}",$(document.head,t)),ye(this,e,$e,we,p,{width:0,height:1,x:2,y:3,label:4,colors:15,classes:16,opacity:5,toImageCoordinates:17,scaleX:6,scaleY:7,isActive:8,view_only:9},[-1,-1])}};function _e(e){let t,n;return{c(){t=E("i"),S(t,"class",n="fa fa-"+e[1])},m(e,n){k(e,t,n)},p(e,o){2&o&&n!==(n="fa fa-"+e[1])&&S(t,"class",n)},d(e){e&&_(t)}}}function Ee(e){let t,n,o,s,i,r,c=""!==e[1]&&_e(e);return{c(){t=E("button"),c&&c.c(),n=q(),o=j(e[0]),S(t,"class",s=b(e[2])+" svelte-ft38eo"),S(t,"title",e[3])},m(s,l){k(s,t,l),c&&c.m(t,null),$(t,n),$(t,o),i||(r=C(t,"click",e[4]),i=!0)},p(e,[i]){""!==e[1]?c?c.p(e,i):(c=_e(e),c.c(),c.m(t,n)):c&&(c.d(1),c=null),1&i&&O(o,e[0]),4&i&&s!==(s=b(e[2])+" svelte-ft38eo")&&S(t,"class",s),8&i&&S(t,"title",e[3])},i:l,o:l,d(e){e&&_(t),c&&c.d(),i=!1,r()}}}function Me(e,t,n){let{text:o=""}=t,{icon:s=""}=t,{style:i=""}=t,{tooltip:l=""}=t;return e.$$set=e=>{"text"in e&&n(0,o=e.text),"icon"in e&&n(1,s=e.icon),"style"in e&&n(2,i=e.style),"tooltip"in e&&n(3,l=e.tooltip)},[o,s,i,l,function(t){!function(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}(e,t)}]}const je=class extends xe{constructor(e){var t;super(),document.getElementById("svelte-ft38eo-style")||((t=E("style")).id="svelte-ft38eo-style",t.textContent="button.svelte-ft38eo{display:inline-block;background-color:#eeeeee;width:148px;height:28px;line-height:28px;font-size:13px;padding:0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center;cursor:pointer;border:none;user-select:none}button.svelte-ft38eo:hover{box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}button.svelte-ft38eo:active{background-color:#bdbdbd}button.success.svelte-ft38eo{background-color:#4caf50;color:white}button.success.svelte-ft38eo:active{background-color:#388e3c}",$(document.head,t)),ye(this,e,Me,Ee,p,{text:0,icon:1,style:2,tooltip:3})}},qe=[];function Ce(e,t,n){const o=t,s=e.get(o),i=function(e,t=l){let n;const o=[];function s(t){if(p(e,t)&&(e=t,n)){const t=!qe.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),qe.push(n,e)}if(t){for(let e=0;e<qe.length;e+=2)qe[e][0](qe[e+1]);qe.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(i,r=l){const c=[i,r];return o.push(c),1===o.length&&(n=t(s)||l),i(e),()=>{const e=o.indexOf(c);-1!==e&&o.splice(e,1),0===o.length&&(n(),n=null)}}}}(void 0===s?n:s);return e.on("change:"+o,(()=>i.set(e.get(o))),null),{set:t=>{i.set(t),e.set(o,t),e.save_changes()},subscribe:i.subscribe,update:t=>{i.update((n=>{let s=t(n);return e.set(o,s),e.save_changes(),s}))}}}function Se(e,{delay:t=0,duration:n=400,easing:o=r}={}){const s=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:o,css:e=>"opacity: "+e*s}}const{Map:Oe}=de;function Ae(e,t,n){const o=e.slice();return o[54]=t[n],o[56]=n,o}function ze(e,t,n){const o=e.slice();return o[57]=t[n],o[58]=t,o[56]=n,o}function De(e){let t,n,o,s,i,l,r,c,u=[],d=new Oe,p=e[0];const f=e=>e[10][e[56]];for(let t=0;t<p.length;t+=1){let n=ze(e,p,t),o=f(n);d.set(o,u[t]=Be(o,n))}return{c(){t=M("svg"),n=M("defs"),o=M("filter"),s=M("feFlood"),i=M("feComposite");for(let e=0;e<u.length;e+=1)u[e].c();S(s,"flood-color","rgba(255,255,255,0.5)"),S(i,"in","SourceGraphic"),S(i,"operator","xor"),S(o,"x","0"),S(o,"y","0"),S(o,"width","1"),S(o,"height","1"),S(o,"id","bg-text"),S(t,"width",e[6]),S(t,"height",e[5]),S(t,"class","svelte-o0quu8")},m(a,d){k(a,t,d),$(t,n),$(n,o),$(o,s),$(o,i);for(let e=0;e<u.length;e+=1)u[e].m(t,null);l=!0,r||(c=[C(t,"mousedown",e[25]),C(t,"mousemove",e[27]),C(t,"mouseup",e[26])],r=!0)},p(e,n){1887485415&n[0]&&(p=e[0],ie(),u=function(e,t,n,o,s,i,l,r,c,u,a,d){let p=e.length,f=i.length,h=p;const b={};for(;h--;)b[e[h].key]=h;const g=[],m=new Map,y=new Map;for(h=f;h--;){const e=d(s,i,h),o=n(e);let r=l.get(o);r?r.p(e,t):(r=u(o,e),r.c()),m.set(o,g[h]=r),o in b&&y.set(o,Math.abs(h-b[o]))}const x=new Set,v=new Set;function w(e){re(e,1),e.m(r,a),l.set(e.key,e),a=e.first,f--}for(;p&&f;){const t=g[f-1],n=e[p-1],o=t.key,s=n.key;t===n?(a=t.first,p--,f--):m.has(s)?!l.has(o)||x.has(o)?w(t):v.has(s)?p--:y.get(o)>y.get(s)?(v.add(o),w(t)):(x.add(s),p--):(c(n,l),p--)}for(;p--;){const t=e[p];m.has(t.key)||c(t,l)}for(;f;)w(g[f-1]);return g}(u,n,f,0,e,p,d,t,pe,Be,null,ze),le()),(!l||64&n[0])&&S(t,"width",e[6]),(!l||32&n[0])&&S(t,"height",e[5])},i(e){if(!l){for(let e=0;e<p.length;e+=1)re(u[e]);l=!0}},o(e){for(let e=0;e<u.length;e+=1)ce(u[e]);l=!1},d(e){e&&_(t);for(let e=0;e<u.length;e+=1)u[e].d();r=!1,a(c)}}}function Be(e,t){let n,o,s,i,l,r,c,u,a;function d(e){t[39](e,t[57])}function p(e){t[40](e,t[57])}function f(e){t[41](e,t[57])}function h(e){t[42](e,t[57])}function b(e){t[43](e,t[57])}let g={toImageCoordinates:t[23],classes:t[2],colors:t[15],scaleX:t[6]/t[8],scaleY:t[5]/t[7],isActive:t[10][t[56]]===t[1],view_only:t[13]};return void 0!==t[57].x&&(g.x=t[57].x),void 0!==t[57].y&&(g.y=t[57].y),void 0!==t[57].width&&(g.width=t[57].width),void 0!==t[57].height&&(g.height=t[57].height),void 0!==t[57].label&&(g.label=t[57].label),o=new ke({props:g}),R.push((()=>he(o,"x",d))),R.push((()=>he(o,"y",p))),R.push((()=>he(o,"width",f))),R.push((()=>he(o,"height",h))),R.push((()=>he(o,"label",b))),o.$on("remove",(function(){return t[44](t[57])})),o.$on("move",(function(...e){return t[45](t[56],...e)})),o.$on("create",t[30]),o.$on("label",(function(){return t[46](t[57],t[58],t[56])})),{key:e,first:null,c(){n=M("g"),be(o.$$.fragment),this.first=n},m(e,t){k(e,n,t),ge(o,n,null),a=!0},p(e,n){t=e;const u={};4&n[0]&&(u.classes=t[2]),32768&n[0]&&(u.colors=t[15]),320&n[0]&&(u.scaleX=t[6]/t[8]),160&n[0]&&(u.scaleY=t[5]/t[7]),1027&n[0]&&(u.isActive=t[10][t[56]]===t[1]),8192&n[0]&&(u.view_only=t[13]),!s&&1&n[0]&&(s=!0,u.x=t[57].x,U((()=>s=!1))),!i&&1&n[0]&&(i=!0,u.y=t[57].y,U((()=>i=!1))),!l&&1&n[0]&&(l=!0,u.width=t[57].width,U((()=>l=!1))),!r&&1&n[0]&&(r=!0,u.height=t[57].height,U((()=>r=!1))),!c&&1&n[0]&&(c=!0,u.label=t[57].label,U((()=>c=!1))),o.$set(u)},i(e){a||(re(o.$$.fragment,e),J((()=>{u||(u=ae(n,Se,{duration:100},!0)),u.run(1)})),a=!0)},o(e){ce(o.$$.fragment,e),u||(u=ae(n,Se,{duration:100},!1)),u.run(0),a=!1},d(e){e&&_(n),me(o),e&&u&&u.end()}}}function Pe(e){let t,n,o,s,i,l,r=e[54]+"",c=e[56]<=9&&function(e){let t,n,o=(e[56]+1)%10+"";return{c(){t=E("span"),n=j(o),S(t,"class","key svelte-o0quu8")},m(e,o){k(e,t,o),$(t,n)},d(e){e&&_(t)}}}(e);function u(){return e[47](e[54])}return{c(){t=E("div"),n=j(r),o=q(),c&&c.c(),s=q(),S(t,"class","class-label svelte-o0quu8"),A(t,"color",e[15][e[56]%e[15].length]),A(t,"border",(e[54]===e[11]?1:0)+"px solid "+e[15][e[56]%e[15].length])},m(e,r){k(e,t,r),$(t,n),$(t,o),c&&c.m(t,null),$(t,s),i||(l=C(t,"click",u),i=!0)},p(o,s){e=o,4&s[0]&&r!==(r=e[54]+"")&&O(n,r),32768&s[0]&&A(t,"color",e[15][e[56]%e[15].length]),34820&s[0]&&A(t,"border",(e[54]===e[11]?1:0)+"px solid "+e[15][e[56]%e[15].length])},d(e){e&&_(t),c&&c.d(),i=!1,l()}}}function Ke(e){let t,n,o,s,i,l,r,c,u,d,p,f,h,b,g,m,y,x,v;o=new je({props:{text:"Skip",icon:"arrow-right",tooltip:"Keyboard shortcut: Space"}}),o.$on("click",e[33]),i=new je({props:{text:"Submit",icon:"check",style:"success",tooltip:"Keyboard shortcut: Enter"}}),i.$on("click",e[34]);let w=e[9]&&De(e),M=e[2],j=[];for(let t=0;t<M.length;t+=1)j[t]=Pe(Ae(e,M,t));return{c(){t=E("div"),n=E("div"),be(o.$$.fragment),s=q(),be(i.$$.fragment),l=q(),r=E("div"),c=E("div"),u=E("img"),f=q(),w&&w.c(),h=q(),b=E("div"),g=E("p"),g.textContent="Classes:",m=q();for(let e=0;e<j.length;e+=1)j[e].c();S(n,"class","buttons svelte-o0quu8"),u.src!==(d=e[14])&&S(u,"src",d),S(u,"alt","annotate me"),S(u,"class","svelte-o0quu8"),S(c,"class","image-measure svelte-o0quu8"),J((()=>e[38].call(c))),S(r,"class","image svelte-o0quu8"),S(b,"class","classes svelte-o0quu8"),S(t,"class","wrapper svelte-o0quu8"),S(t,"tabindex","0")},m(a,d){k(a,t,d),$(t,n),ge(o,n,null),$(n,s),ge(i,n,null),$(t,l),$(t,r),$(r,c),$(c,u),e[37](u),p=function(e,t){"static"===getComputedStyle(e).position&&(e.style.position="relative");const n=E("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const o=D();let s;return o?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=C(window,"message",(e=>{e.source===n.contentWindow&&t()}))):(n.src="about:blank",n.onload=()=>{s=C(n.contentWindow,"resize",t)}),$(e,n),()=>{(o||s&&n.contentWindow)&&s(),_(n)}}(c,e[38].bind(c)),$(r,f),w&&w.m(r,null),$(t,h),$(t,b),$(b,g),$(b,m);for(let e=0;e<j.length;e+=1)j[e].m(b,null);e[48](t),y=!0,x||(v=[C(u,"load",e[24]),C(t,"keydown",e[49]),C(t,"keyup",e[50]),C(t,"blur",e[51])],x=!0)},p(e,t){if((!y||16384&t[0]&&u.src!==(d=e[14]))&&S(u,"src",d),e[9]?w?(w.p(e,t),512&t[0]&&re(w,1)):(w=De(e),w.c(),re(w,1),w.m(r,null)):w&&(ie(),ce(w,1,1,(()=>{w=null})),le()),34820&t[0]){let n;for(M=e[2],n=0;n<M.length;n+=1){const o=Ae(e,M,n);j[n]?j[n].p(o,t):(j[n]=Pe(o),j[n].c(),j[n].m(b,null))}for(;n<j.length;n+=1)j[n].d(1);j.length=M.length}},i(e){y||(re(o.$$.fragment,e),re(i.$$.fragment,e),re(w),y=!0)},o(e){ce(o.$$.fragment,e),ce(i.$$.fragment,e),ce(w),y=!1},d(n){n&&_(t),me(o),me(i),e[37](null),p(),w&&w.d(),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(j,n),e[48](null),x=!1,a(v)}}}function Ne(e,t,n){let o,s,i,l,r,c,u,a,{model:d}=t,p=0,f=0,b=0,m=0,y=!1,x=[],v=[],w="",$=null,k=!1,_=new Set,E=Ce(d,"image","");h(e,E,(e=>n(14,r=e)));let M=Ce(d,"classes",[""]);h(e,M,(e=>n(2,l=e)));let j=Ce(d,"colors",["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"]);h(e,j,(e=>n(15,c=e)));let q=Ce(d,"bboxes",[]);h(e,q,(e=>n(36,i=e)));let C=Ce(d,"selected_index",-1);h(e,C,(e=>n(1,s=e)));let S=Ce(d,"view_only",!1);function O(e){const t=a.getBoundingClientRect();return{x:(e.clientX-t.left)*m/f,y:(e.clientY-t.top)*b/p}}function A(){d.unset("bboxes",{silent:!0}),d.set("bboxes",i),d.save_changes()}function z(e){const t=i.indexOf(e);s>t&&g(C,s-=1,s),s==i.length-1&&g(C,s=-1,s),g(q,i=i.filter((t=>t!==e)),i)}h(e,S,(e=>n(13,o=e)));const D=new Map([["KeyW","up"],["KeyA","left"],["KeyS","down"],["KeyD","right"],["KeyQ","shrink-width"],["KeyE","grow-width"],["KeyR","grow-height"],["KeyF","shrink-height"]]);function B(e){if(e.stopPropagation(),e.preventDefault(),e.code.startsWith("Digit")||/Numpad\d/.test(e.code)){let t=Number(e.code.slice(-1));0===t&&(t=10),t-=1,t<l.length&&n(11,w=l[t])}else if("Escape"===e.code)u.blur();else if("Tab"===e.code){const t=e.shiftKey?-1:1;g(C,s+=t,s),s>=i.length?g(C,s=-1,s):-2===s&&g(C,s=i.length-1,s)}else"Space"===e.code?P():"Enter"!==e.code&&"NumpadEnter"!==e.code||K();if(s>=0&&!o){let t=D.get(e.code);t&&_.add(t),"Delete"===e.code&&z(i[s]),"KeyC"===e.code&&g(q,i[s].label=w,i);let n=e.shiftKey?10:1,o=0,l=0,r=0,c=0;for(let e of _)"up"===e?l-=n:"down"===e?l+=n:"right"===e?o+=n:"left"===e?o-=n:"shrink-width"===e?(r-=2*n,o+=n):"grow-width"===e?(r+=2*n,o-=n):"shrink-height"===e?(c-=2*n,l+=n):"grow-height"===e&&(c+=2*n,l-=n);0===o&&0===l&&0===r&&0===c||(g(q,i[s].x+=o,i),g(q,i[s].y+=l,i),g(q,i[s].width+=r,i),g(q,i[s].height+=c,i),A())}}function P(){d.send({type:"skip"},{}),u.focus()}function K(){d.send({type:"submit"},{}),u.focus()}return e.$$set=e=>{"model"in e&&n(35,d=e.model)},e.$$.update=()=>{4&e.$$.dirty[0]&&n(11,w=l.length>0?l[0]:""),2&e.$$.dirty[0]|32&e.$$.dirty[1]&&s>=i.length&&g(C,s=-1,s),2&e.$$.dirty[0]|32&e.$$.dirty[1]&&n(0,x=-1===s?i:[...i.filter(((e,t)=>t!==s)),i[s]]),1&e.$$.dirty[0]&&n(10,v=x.map(((e,t)=>{return n=t,-1===s?n:n===i.length-1?s:n<s?n:n+1;var n})))},[x,s,l,u,a,p,f,b,m,y,v,w,$,o,r,c,_,E,M,j,q,C,S,O,function(){n(9,y=!0),n(8,m=a.naturalWidth),n(7,b=a.naturalHeight);const e=a.getBoundingClientRect();n(5,p=e.height),n(6,f=e.width)},function(e){if(0!==e.button)return;if(o)return void g(C,s=-1,s);const{x:t,y:n}=O(e),l={x:Math.round(t),y:Math.round(n),width:0,height:0,label:w};k=!0,g(q,i=[...i,l],i),g(C,s=i.length-1,s)},function(e){0===e.button&&(e.preventDefault(),n(12,$=null),A())},function(e){null!==$&&$(e)},A,z,function(e){k&&(n(12,$=e.detail),k=!1)},D,B,P,K,d,i,function(e){R[e?"unshift":"push"]((()=>{a=e,n(4,a)}))},function(){p=this.clientHeight,f=this.clientWidth,n(5,p),n(6,f)},function(t,o){e.$$.not_equal(o.x,t)&&(o.x=t,n(0,x),n(1,s),n(36,i))},function(t,o){e.$$.not_equal(o.y,t)&&(o.y=t,n(0,x),n(1,s),n(36,i))},function(t,o){e.$$.not_equal(o.width,t)&&(o.width=t,n(0,x),n(1,s),n(36,i))},function(t,o){e.$$.not_equal(o.height,t)&&(o.height=t,n(0,x),n(1,s),n(36,i))},function(t,o){e.$$.not_equal(o.label,t)&&(o.label=t,n(0,x),n(1,s),n(36,i))},e=>z(e),(e,t)=>{n(12,$=t.detail),g(C,s=v[e],s)},(e,t,o)=>{n(0,t[o].label=w,x),A()},e=>n(11,w=e),function(e){R[e?"unshift":"push"]((()=>{u=e,n(3,u)}))},e=>B(e),e=>_.delete(D.get(e.code)),()=>_.clear()]}const Ie=class extends xe{constructor(e){var t;super(),document.getElementById("svelte-o0quu8-style")||((t=E("style")).id="svelte-o0quu8-style",t.textContent=".wrapper.svelte-o0quu8{position:relative;margin:1px;padding:4px}.image.svelte-o0quu8{position:relative}.image-measure.svelte-o0quu8{display:table}img.svelte-o0quu8{display:block}svg.svelte-o0quu8{position:absolute;top:0;left:0}.class-label.svelte-o0quu8{cursor:pointer;border-radius:4px;padding:4px;margin:4px;display:inline-block\n  }.classes.svelte-o0quu8{margin-bottom:10px}.buttons.svelte-o0quu8{margin-bottom:10px}span.key.svelte-o0quu8{border:1px solid lightgray;color:gray;padding:0px 3px;font-size:80%;border-radius:2px}",$(document.head,t)),ye(this,e,Ne,Ke,p,{model:35},[-1,-1])}};class We extends i.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:We.model_name,_model_module:We.model_module,_model_module_version:We.model_module_version,_view_name:We.view_name,_view_module:We.view_module,_view_module_version:We.view_module_version})}}We.serializers=Object.assign({},i.DOMWidgetModel.serializers),We.model_name="BBoxModel",We.model_module=n,We.model_module_version=t,We.view_name="BBoxView",We.view_module=n,We.view_module_version=t;class Te extends i.DOMWidgetView{render(){new Ie({target:this.el,props:{model:this.model}})}}window.__webpack_public_path__=document.querySelector("body").getAttribute("data-base-url")+"nbextensions/jupyter_bbox_widget"})(),s})()));
//# sourceMappingURL=index.js.map