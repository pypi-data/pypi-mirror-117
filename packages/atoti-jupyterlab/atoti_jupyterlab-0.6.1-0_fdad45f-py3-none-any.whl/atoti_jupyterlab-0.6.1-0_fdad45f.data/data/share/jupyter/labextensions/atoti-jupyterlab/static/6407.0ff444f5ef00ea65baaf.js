(self.webpackChunkatoti_jupyterlab=self.webpackChunkatoti_jupyterlab||[]).push([[6407],{66794:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>us});const n="Content-Type",i="application/json",o=(e,{requestInit:t={}}={})=>async(s,{body:o,contentType:r=i,method:a}={})=>{const d=`${e}${s.startsWith("/")?s:`/${s}`}`,l=await fetch(d,{...t,body:o,headers:{...t.headers,...r?{[n]:r}:{}},method:a});if(!l.ok){const e=await l.json();throw console.error(e),new Error(`Unexpected response status: ${l.status}`)}const c=l.headers.get(n)===i,u=await(c?l.json():l.text());if(c){const{data:e}=u;return void 0===e?u:e}return u},r="default",a="ROLE_ADMIN",d="ROLE_USER",l="anonymousUser";var c=s(97030),u=s.n(c);const h=e=>void 0!==e,g=(...e)=>{if(!window.__UNSTABLE_DATA_TEST_IDS_ENABLED__)return;const t=e[e.length-1];if(u()(t)){const s=t["data-testid"],n=e.slice(0,-1).filter(h);if(s){const e=s.replace("atoti:","");return`atoti:${[...n.filter(h),e].join(":")}`}return`atoti:${n.join(":")}`}return`atoti:${e.filter(h).join(":")}`},p=s(3265).i8;var m=s(88841),y=s(33967),w=s(28050),f=s(40879),x=s(21123),v=s(39030),C=s(32684),b=s(96177);const S=e=>"mapping"in e;var k=s(6168),j=s(88306),M=s.n(j),E=s(56271),T=s(50308),I=s.n(T),_=s(93100);const L=(e,{getCurrentValue:t})=>{const s=(0,E.useCallback)((t=>e?(e.connect(t),()=>{e.disconnect(t)}):I()),[e]);return(0,_.useSubscription)({getCurrentValue:t,subscribe:s})},P=(e,{property:t,sender:s})=>{const n=(0,E.useCallback)((()=>{if(s)return s[t]}),[t,s]);return L(e,{getCurrentValue:n})};class R{constructor(e,t){this.isUndoingOrRedoing=!1,this.index=0,this.states=[e],this.onChange=()=>{this.isUndoingOrRedoing=!0;try{t(this.states[this.index])}finally{this.isUndoingOrRedoing=!1}}}get canRedo(){return this.index<this.states.length-1}get canUndo(){return this.index>0}set(e){this.isUndoingOrRedoing||(this.index++,this.states.length=this.index,this.states.push(e))}redo(){if(!this.canRedo)throw new Error("Cannot redo");this.index++,this.onChange()}undo(){if(!this.canUndo)throw new Error("Cannot undo");this.index--,this.onChange()}}const $="atoti",D="widget",U=360,A=e=>e.get($)||void 0,W=({code:e,state:t})=>({cell_type:"code",metadata:{[$]:{[D]:(0,x.hNS)(t)}},source:e}),N=e=>{var t;return(null===(t=A(e))||void 0===t?void 0:t.height)||U};class O{constructor(e,{widgetPlugins:t}){this._changed=new k.Signal(this),this._isDeferredChanged=new k.Signal(this),this._isDeferred=!1,this._isDisposed=!1,this.cellMetadata=e,this.undoableState=new R(this.current,(e=>{this.current=e}));const s=(e,{key:t,newValue:s})=>{t===$&&(this.undoableState.set(s),this._changed.emit())};this.cellMetadata.changed.connect(s),this.disconnectFromCellMetadataChangedSignal=()=>{this.cellMetadata.changed.disconnect(s)},this.memoizedDeserializeWidgetState=M()((e=>{if(e)return(0,x.mh8)(e)})),this.widgetPlugins=t}get defaultWidgetState(){return this.widgetPlugins[0].initialState}get canRedo(){return this.undoableState.canRedo}get canUndo(){return this.undoableState.canUndo}get changed(){return this._changed}get current(){return A(this.cellMetadata)}set current(e){e?this.cellMetadata.set($,e):this.cellMetadata.delete($)}dispose(){this.isDisposed||(this._isDisposed=!0,this.disconnectFromCellMetadataChangedSignal(),k.Signal.clearData(this))}get isDeferred(){return this._isDeferred}set isDeferred(e){this._isDeferred=e,this._isDeferredChanged.emit()}get isDeferredChanged(){return this._isDeferredChanged}get isDisposed(){return this._isDisposed}setHeight(e){this.setMetadataProperty("height",e)}setMetadataProperty(e,t){const{current:s}=this;this.current={...s,[e]:t}}setSerializedWidgetState(e){this.setMetadataProperty(D,e)}setWidgetState(e){this.setSerializedWidgetState((0,x.hNS)(e))}redo(){this.undoableState.redo()}undo(){this.undoableState.undo()}}const q=e=>({isDeferred:P(e.isDeferredChanged,{property:"isDeferred",sender:e}),setIsDeferred:(0,E.useCallback)((t=>{e.isDeferred=t}),[e])}),B=e=>{const t=(0,E.useCallback)((t=>{e.setWidgetState(t)}),[e]),{[D]:s}=P(e.changed,{property:"current",sender:e})||{};return{setWidgetState:t,widgetState:e.memoizedDeserializeWidgetState(s)}};var F=s(8336),H=s(61162);const z=({children:e,icon:t,id:s})=>{const{formatMessage:n}=(0,b.useIntl)();return(0,F.jsx)("div",{css:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center"}},(0,F.jsx)(H.default,{description:(0,F.jsx)("span",{css:{color:"var(--jp-ui-font-color1)"}},(0,F.jsx)("span",{css:{fontSize:"var(--jp-ui-font-size2)"}},n({id:`${s}.title`})),(0,F.jsx)("br",null),(0,F.jsx)("span",{css:{color:"var(--jp-ui-font-color2)",fontSize:"var(--jp-ui-font-size1)"}},n({id:`${s}.description`}))),image:t,imageStyle:{fontSize:42,height:60}},e))};var V=s(61838);const K=({hasSnapshot:e})=>e?(0,F.jsx)(z,{icon:(0,F.jsx)(V.PictureOutlined,null),id:"widget.snapshotSelected"}):(0,F.jsx)(z,{icon:(0,F.jsx)(V.ApiOutlined,null),id:"widget.waitingForConnection"}),Q=(0,E.createContext)(void 0),J=()=>(0,E.useContext)(Q),Y=(0,E.createContext)(void 0),X=({cellMetadata:e,children:t,hasSnapshot:s})=>{const n=J(),i=(0,E.useCallback)((()=>n.get(e)),[e,n]),o=L(n.created,{getCurrentValue:i});return o?(0,F.jsx)(Y.Provider,{value:o},t):(0,F.jsx)(K,{hasSnapshot:s})},Z=()=>(0,E.useContext)(Y);class G{constructor({widgetPlugins:e}){this._created=new k.Signal(this),this.widgetStateTrackers=new WeakMap,this.widgetPlugins=e}get created(){return this._created}get(e){return this.widgetStateTrackers.get(e)}getOrCreate(e){return this.widgetStateTrackers.has(e)||(this.widgetStateTrackers.set(e,new O(e,{widgetPlugins:this.widgetPlugins})),this._created.emit()),this.get(e)}}const ee=async({code:e,notebookTracker:t,state:s})=>{const n=t.currentWidget;if(!n)throw new Error("Notebook has no current panel.");const i=n.model;if(!i)throw new Error("Current notebook panel has no model.");const o=i.contentFactory.createCodeCell({cell:W({code:e,state:s})}),r=n.content;i.cells.insert(r.activeCellIndex+1,o),r.activeCellIndex++;const a=r.activeCell;return await w.NotebookActions.run(r,n.sessionContext),a},te=e=>{const t=P(e.activeCellChanged,{property:"activeCell",sender:e});if(t&&(0,C.isCodeCellModel)(t.model))return t.model},se=(e,t)=>{for(let s=0;s<e.length;s++){const n=e.get(s);if(t(n))return n}};var ne=s(19850);const ie="text/html",oe="0.6.1".split(".",1).pop(),re=`application/vnd.atoti.link.v${oe}+json`,ae=`application/vnd.atoti.widget.v${oe}+json`,de=`application/vnd.atoti.convert-query-result-to-widget.v${oe}+json`,le="atoti-sidebar",ce=({jupyterLab:e})=>{e.shell.activateById(le)};var ue=s(66510);const he="ant-root",ge=(0,E.forwardRef)((({children:e,height:t,...s},n)=>(0,F.jsx)("div",{...s,ref:n,className:he,css:{height:t}},e)));var pe=s(64992),me=s(68049),ye=s(98310);const we=()=>{const e=document.querySelector(`#${x.pt}`);if(!e)throw new Error("Missing overlay root DOM node.");return e};var fe=s(73886);const xe=fe.PageConfig.getBaseUrl(),ve=fe.URLExt.join(xe,"proxy"),Ce=async(e,{jupyterServerProxyEnabled:t})=>{const{hostname:s}=new URL(xe),n="url"in e?e.url:`${e.https?"https":"http"}://${s}:${e.port}`,i=[];if(t&&!n.startsWith(ve)){const{hostname:e,pathname:t,port:o,protocol:r}=new URL(n),a=o||("https:"===r?"443":"80"),d=t&&"/"!==t?[t]:[];i.push(fe.URLExt.join(ve,a,...d)),e!==s&&i.push(fe.URLExt.join(ve,`${e}:${a}`,...d))}i.push(n);for(const e of i)try{const t=o(e);return{sessionUrl:e,versions:await t("versions/rest")}}catch(e){}throw new Error("Cannot access the session after trying "+(1===i.length?`this URL: ${i[0]}`:`these URLs: ${i.join(", ")}`))},be=(e,t="")=>{const{pathname:s}=new URL(e);return""===t?`${e}${""===s||"/"===s?"":"/"}`:`${e}/${t}`};class Se{constructor({activePivotClient:e,contentClient:t,fetch:s,id:n,isQuerySession:i,url:o,versions:r}){this._disposed=new k.Signal(this),this._isDisposed=!1,this.subscriberCount=0,this.activePivotClient=e,this.contentClient=t,this.fetch=s,this.stopSyncingDataModel=i?()=>{}:((e,{activePivotUrl:t})=>{const s=t.replace(/^(http)(s)?:\/\//,"ws$2://"),n=`${s.endsWith("/")?s:`${s}/`}atoti/discovery`;let i;const o=t=>{"connected"===t?(i=new WebSocket(n),i.addEventListener("message",(({data:t})=>{const s=JSON.parse(t);e.__UNSAFE_setDataModel__(s)}))):"disconnected"===t&&i&&(i.close(),i=void 0)};return o(e.connectionStatus),e.addConnectionStatusListener(o),()=>{e.removeConnectionStatusListener(o),i&&i.close()}})(e,{activePivotUrl:o}),this.id=n,this.isQuerySession=i,this.url=o,this.versions=r}static async create({jupyterServerProxyEnabled:e,sessionHeaders:t,sessionId:s,sessionLocation:n}){const i="url"in n;i||(e=>{const t=new Headers(e).get("authorization");if(!t)throw new Error(`Missing Authorization header in ${JSON.stringify(e)}.`);const{username:s}=(e=>{const{authorities:t,sub:s}=JSON.parse(atob(e.split(".",2).pop())),n={roles:t,username:s};if(!(s!==l||t.includes(d)&&t.includes(a)))throw new Error(`Anonymous user should have roles ROLE_USER and ROLE_ADMIN but had roles: ${t}.`);return n})(t.split(" ",2).pop());if(s!==l)throw new Error(`Expected username to be anonymousUser but was ${s}.`)})(t);const{sessionUrl:r,versions:c}=await Ce(n,{jupyterServerProxyEnabled:e}),u=null===t?void 0:{credentials:"include",headers:t,mode:"cors"},h=(0,x.Vse)({requestInit:u,url:r,version:c.apis.pivot.versions[0]});await h.loadDataModel();const g=(0,x.u$l)({requestInit:u,url:r,version:c.apis.content.versions[0]}),p=o(r,{requestInit:u});return new Se({activePivotClient:h,contentClient:g,fetch:p,id:s,isQuerySession:i,url:r,versions:c})}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(),this.activePivotClient.disconnect(),this.stopSyncingDataModel(),k.Signal.clearData(this))}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}subscribe(){this.subscriberCount++}unsubscribe(){this.subscriberCount--,0===this.subscriberCount&&this.dispose()}}const ke=(0,E.createContext)(void 0),je=()=>(0,E.useContext)(ke),Me=({children:e=null})=>{const t=(0,x.TtI)()[r];return t&&(({catalogs:e})=>e.some((({cubes:e})=>e.length>0)))(t)?e:(0,F.jsx)(z,{icon:(0,F.jsx)(x.qEg,null),id:"widget.sessionHasNoCubes"})},Ee=(0,E.createContext)(void 0),Te={username:l,userRoles:[a,d]},Ie=({children:e,sessionId:t})=>{const s=je(),n=(0,E.useCallback)((()=>s.get(t)),[s,t]),i=L(s.changed,{getCurrentValue:n}),o=(0,E.useMemo)((()=>{const e={};return i&&(e[r]=i.activePivotClient),e}),[i]),a=(0,E.useMemo)((()=>null==i?void 0:i.contentClient),[i]);return i?(0,F.jsx)(x.drd,{value:Te},(0,F.jsx)(x.u_E,{value:{activePivot:o,content:a}},(0,F.jsx)(Ee.Provider,{value:i},(0,F.jsx)(Me,null,e)))):(0,F.jsx)(K,null)},_e=()=>(0,E.useContext)(Ee);class Le{constructor(){this._changed=new k.Signal(this),this.sessionClients={},this.sessionClientCreations={}}get changed(){return this._changed}get(e){return this.sessionClients[e]}async getOrCreate({jupyterServerProxyEnabled:e,sessionHeaders:t,sessionId:s,sessionLocation:n}){const i=this.get(s);if(i){const{activePivotClient:e}=i;return"disconnected"===e.connectionStatus&&await e.connect(),i}return s in this.sessionClientCreations||(this.sessionClientCreations[s]=Promise.resolve().then((async()=>{const i=await Se.create({jupyterServerProxyEnabled:e,sessionHeaders:t,sessionId:s,sessionLocation:n}),o=()=>{Reflect.deleteProperty(this.sessionClients,s),this._changed.emit(),i.disposed.disconnect(o)};i.disposed.connect(o),this.sessionClients[s]=i,Reflect.deleteProperty(this.sessionClientCreations,s),this._changed.emit()}))),await this.sessionClientCreations[s],this.sessionClients[s]}}const Pe=(0,E.createContext)(void 0),Re=(0,E.createContext)(!1),$e=(0,E.createContext)(void 0),De=({children:e,value:{intlTracker:t,jupyterLab:s,jupyterServerProxyEnabled:n,notebookTracker:i,pluginRegistry:o,sessionClients:r,themeTracker:a,widgetStateTrackers:d}})=>{const{locale:l,messages:c}=P(t.changed,{property:"config",sender:t}),u=P(a.changed,{property:"theme",sender:a});return(0,F.jsx)(pe.default,{getPopupContainer:we},(0,F.jsx)(me.DndProvider,{backend:ye.HTML5Backend},(0,F.jsx)(b.IntlProvider,{locale:l,messages:c},(0,F.jsx)(x.f6W,{value:u},(0,F.jsx)(x.oPk,{value:o},(0,F.jsx)(Pe.Provider,{value:s},(0,F.jsx)(Re.Provider,{value:n},(0,F.jsx)($e.Provider,{value:i},(0,F.jsx)(ke.Provider,{value:r},(0,F.jsx)(Q.Provider,{value:d},e))))))))))},Ue=()=>(0,E.useContext)(Pe),Ae=()=>(0,E.useContext)(Re),We=()=>(0,E.useContext)($e);var Ne=s(21469),Oe=s(4873);const qe=()=>{const e=Z(),{formatMessage:t}=(0,b.useIntl)();return(0,F.jsx)(z,{icon:(0,F.jsx)(V.MehOutlined,null),id:"widget.errored"},(0,F.jsx)(Ne.default,{danger:!0,onClick:()=>{e.current=void 0}},(0,F.jsx)(V.ClearOutlined,null)," ",t({id:"widget.reset"})),e.canUndo?(0,F.jsx)(Ne.default,{css:{marginLeft:"4px !important",marginTop:"4px !important"},onClick:()=>{e.undo()}},(0,F.jsx)(V.UndoOutlined,null)," ",t({id:"aui.plugins.menu-item.undo.key"})):null)},Be=({children:e,widgetLoadingTracker:t})=>{const s=(0,E.useCallback)((async e=>{t&&await t.handleError(e)}),[t]),n=Z(),i=B(n);return(0,F.jsx)(Oe.ErrorBoundary,{FallbackComponent:qe,resetKeys:[i],onError:s},e)};var Fe=s(93897),He=s(71249);const{OptGroup:ze,Option:Ve}=Fe.Z,Ke=({onChange:e,widgetState:t})=>{const{formatMessage:s}=(0,b.useIntl)(),n=(0,x.ANR)(),i=(0,x.h0_)(n).filter((e=>(0,v.vo)(e))),{mapping:o,widgetKey:r}=(0,x.jl5)(t),{attributes:a}=i.find((({key:e})=>e===r)),d=(0,E.useMemo)((()=>{const e={};for(const t of Object.values(i)){const n=t.subCategory||"misc";e[n]||(e[n]=[]);const i=t.Icon||V.QuestionOutlined,{max:r,status:d}=(0,v.WS)(o,a,t.attributes);e[n].push((0,F.jsx)(Ve,{key:t.key,disabled:"ok"!==d,value:t.key,title:"ok"===d?void 0:s({id:"sidebar.switchDisabled"},{max:r,status:d})},(0,F.jsx)(i,{css:{marginRight:4}})," ",s({id:`aui.plugins.widget.${t.key}.key`})))}return e}),[a,i,s,o]);return(0,F.jsx)(Fe.Z,{css:{height:28,marginBottom:"4px !important",width:"100%"},listHeight:30*Object.keys(i).length,value:r,onChange:s=>{e((0,He.produce)(t,(e=>{s===e.widgetKey?delete e.switchedTo:e.switchedTo=s})))}},Object.entries(d).map((([e,t])=>(0,F.jsx)(ze,{key:e,label:s({id:`aui.dataVisualization.category.${e}`})},t))))};var Qe=s(64994);const Je=()=>{const e=Z(),{isDeferred:t,setIsDeferred:s}=q(e),{formatMessage:n}=(0,b.useIntl)();return(0,F.jsx)("div",{css:{alignItems:"center",display:"flex",flexDirection:"row",height:22,justifyContent:"flex-end"}},(0,F.jsx)(Qe.Z,{checked:t,onChange:e=>{s(e.target.checked)}},n({id:"sidebar.deferUpdates"})))},Ye=({cellId:e})=>{const t=Z(),{setWidgetState:s,widgetState:n=t.defaultWidgetState}=B(t),{widgetKey:i}=(0,x.jl5)(n),[o]=(0,x.h0_)([i]),r=o.contentEditor;return(0,F.jsx)("div",{css:{display:"flex",flexDirection:"column",height:"100%"}},S(n)?(0,F.jsx)(Ke,{widgetState:n,onChange:s}):null,(0,F.jsx)("div",{css:{height:`calc(100% - ${22+(S(n)?32:0)}px)`}},(0,F.jsx)(r,{widgetState:n,queryId:e,onWidgetChange:s})),(0,F.jsx)(Je,null))},Xe=()=>{const e=We(),t=te(e),s=(e=>{P(null==e?void 0:e.outputs.changed,{property:"length",sender:null==e?void 0:e.outputs});const t=e?se(e.outputs,(e=>void 0!==e.data[ae])):void 0;if(!t)return;const{data:s}=t,n=ie in s,{sessionId:i}=s[ae];return{hasSnapshot:n,sessionId:i}})(t);if(!t||!s)return(0,F.jsx)(z,{icon:(0,F.jsx)(x.Iwf,null),id:"sidebar.noWidgetSelected"});const{hasSnapshot:n,sessionId:i}=s;return(0,F.jsx)(X,{cellMetadata:t.metadata,hasSnapshot:n},(0,F.jsx)(Ie,{sessionId:i},(0,F.jsx)(Be,null,(0,F.jsx)(Ye,{cellId:t.id}))))},Ze=".atoti-icon.jp-SideBar-tabIcon";class Ge extends ue.Widget{constructor(e){super(),this.id=le,this.title.caption="atoti",this.title.iconClass="jp-SideBar-tabIcon atoti-icon";const t=y.ReactWidget.create((0,F.jsx)(E.Fragment,null,(0,F.jsx)(F.Global,{styles:{[Ze]:{backgroundColor:"var(--md-grey-700)",backgroundImage:"none",maskImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cg%3E%3Cpath d='M.24 11.88c0-4.43 2.74-7.82 7.05-7.82 1.9-.09 3.7.88 4.65 2.52V4.46h4.68V19.3h-4.68v-2.09c-.8 1.48-2.65 2.49-4.71 2.49-4.43 0-6.99-3.35-6.99-7.82m11.89 0c0-2.13-1.2-3.88-3.54-3.88-2.19 0-3.54 1.63-3.54 3.88s1.35 3.91 3.54 3.91c2.34 0 3.54-1.75 3.54-3.91' /%3E%3Cpath d='M17.91 16.81a2.917 2.917 0 012.96-2.88c1.58.02 2.86 1.3 2.89 2.88a2.947 2.947 0 01-2.97 2.89 2.929 2.929 0 01-2.88-2.89' /%3E%3C/g%3E%3C/svg%3E%0A\")",maskPosition:"center",maskRepeat:"no-repeat",maskSize:"contain"},[`[data-jp-theme-light="false"] ${Ze}`]:{backgroundColor:"var(--md-grey-300)"}}}),(0,F.jsx)(De,{value:e},(0,F.jsx)(Xe,null)))),{classList:s,style:n}=t.node;s.add(he),n.padding="4px 4px 0 4px";const i=new ue.PanelLayout;i.addWidget(t),this.layout=i}}const et="convert-query-result-to-widget",tt=`atoti:${et}`,st=".jp-Notebook .jp-CodeCell .dataframe",nt=e=>{const{activeCell:t}=e,s=t&&(0,C.isCodeCellModel)(t.model)&&se(t.model.outputs,(e=>void 0!==e.data[de]));return s?s.data[de]:void 0};var it=s(20391);const ot="en-US",rt={en:"en-US"},at=e=>{if(!e)return ot;const t=e.get("locale").composite,s=rt[t];return void 0===s?(console.error(`atoti does not support JupyterLab's ${t} locale, falling back to en-US.`),ot):s},dt=async(e,{pluginRegistry:t})=>{const[n,{default:i}]=await Promise.all([(0,x.pr1)(e),s(7147)(`./${e}`)]);return{...n,...(0,x.dUG)(t,e),...(0,it.treeToFlatMap)(i)}};class lt{constructor({initialConfig:e,pluginRegistry:t,translationSettings:s}){this._changed=new k.Signal(this),this._config=e,s&&s.changed.connect((async()=>{const e=at(s),n=await dt(e,{pluginRegistry:t});this._config={locale:e,messages:n},this._changed.emit()}))}static async create({pluginRegistry:e,settingRegistry:t}){const s=await(t?t.load("@jupyterlab/translation-extension:plugin"):void 0),n=at(s),i=await dt(n,{pluginRegistry:e});return new lt({initialConfig:{locale:n,messages:i},pluginRegistry:e,translationSettings:s})}get changed(){return this._changed}get config(){return this._config}}const ct=fe.URLExt.join(fe.PageConfig.getBaseUrl(),"server-proxy","servers-info"),ut=async()=>{try{if((await fetch(ct)).ok)return!0}catch(e){}return!1};var ht=s(19129),gt=s(14456),pt=s.n(gt);const mt=({output:{path:e,sessionLocation:t}})=>{const s=Ae(),[n,i]=(0,E.useState)(),[o,r]=(0,E.useState)();if((0,E.useEffect)((()=>{(async()=>{try{const{sessionUrl:e}=await Ce(t,{jupyterServerProxyEnabled:s});i(e)}catch(e){r(e)}})()}),[s,t]),void 0!==o)return(0,F.jsx)("div",{css:{paddingLeft:"var(--jp-code-padding)"}},o.message);if(void 0===n)return null;const a=be(n,e);return(0,F.jsx)("div",{css:{paddingLeft:"var(--jp-code-padding)"}},(0,F.jsx)("pre",null,(0,F.jsx)("a",{css:{":hover":{color:"var(--jp-content-link-color)",textDecoration:"underline"},color:"var(--jp-content-link-color)"},href:a,target:"_blank",rel:"noopener noreferrer"},a)))};class yt extends w.NotebookTools{constructor(e){super({tracker:e.notebookTracker}),this.sharedContext=e}async renderModel(e){return new Promise((t=>{pt().render((0,F.jsx)(De,{value:this.sharedContext},(0,F.jsx)(mt,{output:e.data[re]})),this.node,t)}))}onBeforeDetach(){pt().unmountComponentAtNode(this.node)}}class wt{constructor(e){this.sharedContext=e}createNew(e,t){return e.content.rendermime.addFactory({createRenderer:()=>new yt(this.sharedContext),defaultRank:0,mimeTypes:[re],safe:!1}),new ht.DisposableSet}}var ft=s(24350),xt=s.n(ft),vt=s(95479),Ct=s(36853),bt=s(22355);const St=(0,E.createContext)(null),kt=St.Provider,jt=()=>(0,E.useContext)(St),Mt="open-drillthrough",Et={Component:(0,v.r3)((e=>{const{cube:t,onClick:s,selection:n,widgetState:i}=e,{formatMessage:o}=(0,b.useIntl)(),a=Ue(),d=We(),{mimeModel:l}=jt(),{widgetCreationCode:c}=l.data[ae],u=(0,E.useMemo)((()=>{if((0,Ct.Yi)(n))return n.cells[0].tuple.filter((e=>"Measures"===e.dimensionName||!(0,vt.Eu)((0,x._yD)(e,t),e)))}),[t,n]),h=(0,E.useMemo)((()=>{if(!u)return;const e=u.filter((e=>"Measures"!==e.dimensionName));return o({id:`aui.plugins.menu-item.${Mt}.openDrillthrough`},{member:e.length>0?(0,vt.eh)(e,{cube:t,hasOnlyCaptionForLeafLevels:!0,separator:", "}):void 0})}),[o,u,t]),g=(0,E.useCallback)((async e=>{if(s&&s(e),h&&u&&i.query.mdx){const e=(0,Ct.j6)({cube:t,sourceWidgetFilters:i.filters,tuple:u}),s={...x.oH_.initialState,filters:e,query:{...x.oH_.initialState.query,mdx:{elementType:"Drillthrough",select:{...i.query.mdx,axes:[],cellProps:void 0,slicerAxis:void 0}}},serverKey:r};ce({jupyterLab:a}),await ee({code:c,notebookTracker:d,state:s})}}),[t,a,h,d,s,u,c,i]);return u&&i.query.mdx?(0,F.jsx)(bt.Z.Item,{...(0,x.IWr)(e),onClick:g},(0,F.jsx)(x.Al8,{css:{marginRight:8}}),h):null})),key:Mt,translations:{"en-US":{openDrillthrough:"Drillthrough {member, select,\n           undefined {}\n           other {on {member}}\n          }"}}};var Tt=s(35411),It=s(86973),_t=s(65096);const{Text:Lt}=_t.Z,Pt={Component:e=>{const{formatMessage:t,locale:s,messages:n}=(0,b.useIntl)(),{contentClient:i,isQuerySession:o,url:r}=_e(),{widgetName:d}=jt(),[l,c]=(0,E.useState)(!1),{widgetState:u}=e,h=(0,E.useCallback)((()=>{let e=!1;return(async()=>{if(!i)throw new Error("Missing content client on local sessions.");c(!0);const{name:o,widgetKey:l,...h}=(0,x.hNS)(u),g=()=>{e||c(!1)},p=[a];try{await i.createFile({content:h,metaData:{name:d||void 0,widgetKey:l},owners:p,pathToFolder:[],readers:p,type:"widget"});const e=be(r);It.default.success({description:(0,F.jsx)(b.IntlProvider,{locale:s,messages:n},(0,F.jsx)(b.FormattedMessage,{id:"aui.plugins.menu-item.publish-widget.successDescription",values:{a:t=>(0,F.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer"},t),b:e=>(0,F.jsx)(Lt,{strong:!0},e),i:()=>(0,F.jsx)(x.Iwf,null)}})),getContainer:we,message:t({id:"aui.plugins.menu-item.publish-widget.successMessage"}),onClose:g})}catch(e){console.error(e),It.default.error({description:String(e),getContainer:we,message:t({id:"aui.plugins.menu-item.publish-widget.errorMessage"}),onClose:g})}})(),()=>{e=!0}}),[i,t,s,n,r,d,u]);return(0,F.jsx)(Tt.default,{...(0,x.IWr)(e),disabled:o||l,title:o?t({id:"aui.plugins.menu-item.publish-widget.querySessionWidgetsCannotBePublished"}):void 0,onClick:h},(0,F.jsx)(E.Fragment,null,(0,F.jsx)(V.ShareAltOutlined,null),t({id:"aui.plugins.menu-item.publish-widget.publishWidgetInApp"})))},key:"publish-widget",translations:{"en-US":{errorMessage:"Widget could not be published",publishWidgetInApp:"Publish in app",querySessionWidgetsCannotBePublished:"Query session widgets cannot be published",successDescription:"Go to <a>the app</a>, create or open a dashboard, and click on the <b><i>icon</i> Widgets</b> icon in the <b>Left bar</b> to find your widget.",successMessage:"Widget published"}}},Rt=e=>xt()(e,"key"),$t=["undo","redo"],Dt=({undoRedoKey:e,...t})=>{const{formatMessage:s}=(0,b.useIntl)(),n=Z();P(n.changed,{property:"current",sender:n});const i=(0,E.useCallback)((()=>{"undo"===e?n.undo():n.redo()}),[e,n]),o="undo"===e?!n.canUndo:!n.canRedo;return(0,F.jsx)(Tt.default,{...(0,x.IWr)(t),disabled:!n||o,title:o?s({id:`aui.plugins.menu-item.${e}.nothingToUndoRedo`}):void 0,onClick:i},"undo"===e?(0,F.jsx)(V.UndoOutlined,null):(0,F.jsx)(V.RedoOutlined,null),s({id:`aui.plugins.menu-item.${e}.key`}))},Ut=(e,{notebookTracker:t,widgetStateTrackers:s})=>n=>{const i=te(t);return i?(0,F.jsx)(Q.Provider,{value:s},(0,F.jsx)(X,{cellMetadata:i.metadata},(0,F.jsx)(Dt,{undoRedoKey:e,...n}))):null},At=[x.TA$,x.a2P,x._ll,x._dN,x.Uou,x.igv,x.W$X,x.$3o,x.GSY,x.Y8R,x.uVH,x.fO6,x.U_o,x.UiH,x.Y5x,x.EAR,x.M1w,x.Oj0,x.NWu,x.iph,x.wSQ,x.teE,x.C1v,x.oH_];x.oH_.cellStyle=x.iOR.key,x.oH_.contextMenuItems=[x._fi.key,x.A8w.key,x.Pmi.key];const Wt=At.filter((({key:e})=>e.startsWith("plotly")));for(const e of Wt)e.contextMenuItems=[...$t,Et.key,x.Uk4.key,x.QYw.key,x.f$L.key,x.XWS.key,x.lJ3.key,Pt.key];x.TA$.cell=x.gRB.key,x.TA$.cellStyle=x.OT2.key,x._ll.cell=x.ASS.key,x._ll.cellStyle=x.eyx.key,x.a2P.cell=x.BUk.key,x.a2P.cellStyle=x.OT2.key;for(const e of[x.TA$,x._ll,x.a2P])e.contextMenuItems=[...$t,Et.key,x.Nn4.key,x.woi.key,x.f$L.key,x.XWS.key,x.oCn.key,x.lJ3.key,Pt.key];x._dN.contextMenuItems=[...$t,x.XWS.key,x.lJ3.key,Pt.key];const Nt="atoti-ant-style",Ot=async e=>{e.theme||(await new Promise((t=>{const s=()=>{e.themeChanged.disconnect(s),t(void 0)};e.themeChanged.connect(s)})),await Ot(e))};class qt{constructor({initialTheme:e,syncTheme:t,themeManager:s}){this._changed=new k.Signal(this),this._theme=e,s.themeChanged.connect((async()=>{this._theme=await t(),this._changed.emit()}))}static async create(e){const t=document.createElement("style");t.id=Nt,t.setAttribute("rel","stylesheet"),document.querySelector("head").append(t),await Ot(e);const n=async()=>{const n=!e.theme||e.isLight(e.theme),i=n?await s.e(2155).then(s.t.bind(s,52155,17)):await s.e(2601).then(s.t.bind(s,82601,17));return t.innerHTML=i.default,n?x.xjl:x.MuJ},i=await n();return new qt({initialTheme:i,syncTheme:n,themeManager:e})}get changed(){return this._changed}get theme(){return this._theme}}class Bt{constructor({cellModels:e}){this._changed=new k.Signal(this),this.messages=new WeakMap,this.cellModels=e}get changed(){return this._changed}get(e){return this.messages.get(e)}register(e){this._changed.emit(),e.registerCommTarget("atoti-widget",((e,{content:{data:t}})=>{const s=t;try{const{cellId:e}=s,t=(0,ne.toArray)(this.cellModels).find((({id:t})=>e===t));if(!t)throw new Error(`Missing model for cell #${e}`);if(!(0,C.isCodeCellModel)(t))throw new Error(`Expected cell #${e} to be a code cell`);const n=se(t.outputs,(e=>void 0!==e.data[ae]));if(!n)throw new Error(`Expected cell #${e} to have a widget output`);this.messages.set(n,s),this._changed.emit()}catch(e){console.error(e)}}))}}const Ft=({children:e})=>{const[t,s]=(0,E.useState)(),n=(0,E.useRef)(null);return(0,E.useEffect)((()=>{const e=n.current;e&&void 0===t&&s(null!==e.closest(".jp-LinkedOutputView"))}),[t]),void 0===t?(0,F.jsx)("div",{ref:n}):e(t)};var Ht=s(27231);const zt={"*":{"-ms-overflow-style":"none","scrollbar-width":"none"},"*::-webkit-scrollbar":{display:"none"}},Vt="http://www.w3.org/2000/svg",Kt=(e,{elements:t,matchedSelectors:s,styles:n})=>{const i=e.selectorText,o=e.style;if(((e,{elements:t,matchedSelectors:s})=>{if(e in s)return s[e];const n=t.some((t=>t.matches(e)));return s[e]=n,s[e]})(i,{elements:t,matchedSelectors:s})){i in n||(n[i]={});const e=n[i];for(const t of o)e[t]=`${o.getPropertyValue(t)}${"important"===o.getPropertyPriority(t)?" !important":""}`}},Qt={left:"scrollLeft",top:"scrollTop"},Jt=e=>{const{clientHeight:t,clientWidth:s}=e,n=document.createElementNS(Vt,"svg");n.setAttribute("xmlns",Vt);const i=document.createElementNS(Vt,"foreignObject");n.setAttribute("height",String(t)),n.setAttribute("width",String(s)),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0");const o=document.createElement("style"),r=(a={...(e=>{if(!document.getElementById(Nt))throw new Error("The stylesheet #atoti-ant-style is missing");const t={},s={},n=[e,...e.querySelectorAll("*")],i=[...document.styleSheets];for(const e of i)try{const i=e.cssRules;for(const e of i)Kt(e,{elements:n,matchedSelectors:t,styles:s})}catch(e){}return s})(e),...zt,".atoti-hidden-in-snapshot":{display:"none"}},Object.entries(a).map((([e,t])=>`${e} {${Object.entries(t).map((([e,t])=>`${e}: ${t}`)).join("; ")}}`)).join("\n"));var a;o.setAttribute("type","text/css"),o.append(document.createTextNode(r)),n.append(i),i.append(o);const d=document.createElement("div");return d.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),d.setAttribute("style",`height: ${t}px; width: ${s}px;`),d.append((e=>{const t=[e,...e.querySelectorAll("*")],s=e.cloneNode(!0),n=[s,...s.querySelectorAll("*")];for(const[e,s]of n.entries()){const n=t[e];for(const[e,t]of Object.entries(Qt)){const i=e,o=n[t];if(0!==o)for(const e of s.children){const{style:s}=e;if(""!==s[i])throw new Error(`Expected child of element with ${t} property of ${o} to have no ${i} style property but has ${s[i]}.`);s[i]=-o+"px"}}}return s})(e)),i.append(d),n},Yt=e=>{const t=document.createElementNS(Vt,"svg");return t.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),t.setAttribute("height",String(e.clientHeight)),t.setAttribute("width",String(e.clientWidth)),((e,t)=>{const{height:s,width:n}=e[0].getBoundingClientRect();t.setAttribute("viewBox",`0 0 ${n} ${s}`);for(const s of e)for(const e of s.children)t.append(e.cloneNode(!0))})(e.querySelectorAll(".svg-container .main-svg"),t),t},Xt=(e,{isPlotlyChart:t})=>(e=>{const t=(new XMLSerializer).serializeToString(e);return`<img src="data:image/svg+xml;charset=utf8,${encodeURIComponent(`<?xml version="1.0" standalone="no"?>${t}`)}">`})((t?Yt:Jt)(e)),Zt=({children:e})=>{const{formatMessage:t}=(0,b.useIntl)(),s=(()=>{const e=We(),t=te(e),{cellMetadata:s}=jt();return!!t&&t.metadata===s})(),{[r]:n}=(0,x.ZmX)(),[i,o]=(0,E.useState)(!1),a=(0,E.useCallback)((()=>{o(!0)}),[]),d="disconnected"===n;return(0,E.useEffect)((()=>{o(!d)}),[d]),(0,F.jsx)(E.Fragment,null,s&&d&&!i?(0,F.jsx)("div",{css:{padding:4,position:"absolute",width:"100%",zIndex:1},className:"atoti-hidden-in-snapshot"},(0,F.jsx)(Ht.default,{closable:!0,showIcon:!0,message:t({id:"widget.sessionDisconnected"}),type:"warning",onClose:a})):null,e)},Gt=({children:e,widgetLoadingTracker:t})=>(0,F.jsx)(Zt,null,(0,F.jsx)(Be,{widgetLoadingTracker:t},e)),es=()=>{const{queryId:e}=jt(),t=Z(),{isDeferred:s}=q(t),{setWidgetState:n,widgetState:i=t.defaultWidgetState}=B(t);return(0,F.jsx)(x.$LY,{isDeferred:s,queryId:e,widgetState:i,onChange:n})},ts=()=>{const{cellMetadata:e,mimeModel:t,sessionId:s}=jt();return(0,F.jsx)(ge,null,(0,F.jsx)(X,{cellMetadata:e,hasSnapshot:Boolean(t.data[ie])},(0,F.jsx)(Ie,{sessionId:s},(0,F.jsx)(Gt,null,(0,F.jsx)(es,null)))))};class ss{constructor({sessionClient:e,widgetId:t}){this.toldLoadingDone=!1,this.toldLoadingStarted=!1,this.sessionClient=e,this.widgetId=t}async started({queriesTimeLimit:e}){this.toldLoadingStarted||this.sessionClient.isQuerySession||(this.toldLoadingStarted=!0,await this.sendLoadingState(!0,{queriesTimeLimit:e}))}async done(){this.toldLoadingDone||this.sessionClient.isQuerySession||(this.toldLoadingDone=!0,await this.sendLoadingState(!1))}async handleError(e){await this.done()}async sendLoadingState(e,{queriesTimeLimit:t}={}){const s=`${this.sessionClient.versions.apis.atoti.versions[0].restPath}/widgets/${this.widgetId}/loading${e&&void 0!==t?`?queriesTimeLimit=${t}`:""}`;await this.sessionClient.fetch(s,{method:e?"POST":"DELETE"})}}const ns=({widgetLoadingTracker:e,widgetRef:t})=>{const{queryId:s}=jt(),n=Z(),{isDeferred:i,setIsDeferred:o}=q(n),{setWidgetState:a,widgetState:d}=B(n),l=d||n.defaultWidgetState,c=((e,{query:t})=>{const s=(0,E.useRef)(t);return(0,E.useEffect)((()=>{(async()=>{var t;if(!(null===(t=s.current)||void 0===t?void 0:t.mdx))return;const{queriesTimeLimit:n}=s.current.context||{};if(void 0!==n&&"number"!=typeof n)throw new Error(`Expected queriesTimeLimit to be a number but was: ${JSON.stringify(n)}`);await e.started({queriesTimeLimit:n})})()}),[e]),(0,E.useEffect)((()=>()=>{(async()=>{await e.done()})()}),[e]),(0,E.useCallback)((async()=>{await e.done()}),[e])})(e,{query:l.query}),u=(({widgetRef:e,widgetState:t})=>{const{mimeModel:s,queryId:n,saveStateSignal:i}=jt(),{widgetKey:o}=(0,x.jl5)(t),a=(0,E.useRef)(!1),d=(0,E.useCallback)((e=>{const{[ie]:t,...n}=s.data;s.setData({data:void 0===e?n:{...n,[ie]:e}})}),[s]),{error:l}=(0,x.bAZ)({queryId:n,serverKey:r});return(0,E.useEffect)((()=>{const t=(t,s)=>{"started"===s&&d(a.current&&!l&&e.current?Xt(e.current,{isPlotlyChart:/plotly-.+-chart/.test(o)}):void 0)};return i.connect(t),()=>{i.disconnect(t)}}),[l,i,d,e,o]),(0,E.useCallback)((()=>{a.current=!0}),[])})({widgetRef:t,widgetState:l}),h=(0,E.useCallback)((()=>{c(),u()}),[c,u]);return(e=>{const t=Ue();(0,E.useEffect)((()=>{e&&ce({jupyterLab:t})}),[e,t])})(void 0===d),(e=>{(0,E.useEffect)((()=>()=>{e(!1)}),[e])})(o),(()=>{const e=_e();(0,E.useEffect)((()=>(e.subscribe(),()=>{e.unsubscribe()})),[e])})(),(0,F.jsx)(x.$LY,{isDeferred:i,queryId:s,widgetState:l,onLoaded:h,onChange:a})};var is=s(83609);const os=(0,E.forwardRef)((({children:e},t)=>{const s=Z(),{height:n,setHeight:i}=(e=>{const t=(0,E.useCallback)((t=>{e.setHeight(t)}),[e]),{height:s=U}=P(e.changed,{property:"current",sender:e})||{};return{height:s,setHeight:t}})(s),{widgetName:o}=jt(),r=(0,x.FgM)();return(0,F.jsx)(F.ClassNames,null,(({css:s})=>(0,F.jsx)(is.Resizable,{handleClasses:{bottom:`atoti-resize-handle ${s({backgroundColor:r.grayScale[6],borderRadius:2,borderTop:"unset",height:"4px !important",marginBottom:6,marginLeft:"calc(50% - 16px)",opacity:.4,width:"32px !important"})}`},size:{height:n,width:"100%"},enable:{bottom:!0,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},css:{"&:hover .atoti-resize-handle":{display:"inherit"},overflow:"hidden",paddingBottom:8},onResizeStop:(e,t,s,o)=>{i(n+o.height)}},(0,F.jsx)(ge,{ref:t,"data-testid":g("Widget",o)},e))))})),rs=({html:e})=>{const t=(0,b.useIntl)(),{widgetName:s}=jt();return(0,F.jsx)("div",{dangerouslySetInnerHTML:{__html:e},css:{cursor:"help"},"data-testid":g("WidgetSnapshot",s),title:t.formatMessage({id:"widget.snapshotSelected.description"})})},as=()=>{const e=(0,E.useRef)(null),{cellMetadata:t,mimeModel:s,sessionId:n}=jt(),i=(()=>{const e=Ae(),t=je(),{cellMetadata:s,mimeModel:n,sessionId:i,sessionLocation:o,widgetComm:r}=jt(),a=J(),d=((e,t)=>{const s=(0,E.useCallback)((()=>e.get(t)),[t,e]);return L(e.changed,{getCurrentValue:s})})(r,n),[l,c]=(0,E.useState)();return(0,E.useEffect)((()=>{let n=!1;return(async()=>{if(!d||l)return;const{sessionHeaders:r,widgetId:u}=d,h=await t.getOrCreate({jupyterServerProxyEnabled:e,sessionHeaders:r,sessionId:i,sessionLocation:o});a.getOrCreate(s),n||l||c(new ss({sessionClient:h,widgetId:u}))})(),()=>{n=!0}}),[s,e,t,i,o,d,l,a]),l})(),o=J().get(t);return i&&o?(0,F.jsx)(X,{cellMetadata:t},(0,F.jsx)(os,{ref:e},(0,F.jsx)(Ie,{sessionId:n},(0,F.jsx)(Gt,{widgetLoadingTracker:i},(0,F.jsx)(ns,{widgetLoadingTracker:i,widgetRef:e}))))):s.data[ie]?(0,F.jsx)(rs,{html:s.data[ie]}):(0,F.jsx)(ge,{height:N(t)},(0,F.jsx)(K,null))},ds=()=>(0,F.jsx)(Ft,null,(e=>e?(0,F.jsx)(ts,null):(0,F.jsx)(as,null)));class ls extends w.NotebookTools{constructor({cellModels:e,notebookContext:t,sharedContext:s,widgetComm:n}){super({tracker:s.notebookTracker}),this.cleanUpFunctions=[],this.cellModels=e,this.notebookContext=t,this.sharedContext=s,this.widgetComm=n}async renderModel(e){const{id:t,metadata:s}=((e,{cellModels:t})=>{const s=(0,ne.toArray)(t).filter(C.isCodeCellModel).find((({outputs:t})=>se(t,(t=>t===e))));if(!s)throw new Error(`Could not find matching cell for model: ${JSON.stringify(e)}`);return s})(e,{cellModels:this.cellModels}),n=e.data[ae],{name:i,sessionId:o,sessionLocation:r}=n;return new Promise((n=>{pt().render((0,F.jsx)(De,{value:this.sharedContext},(0,F.jsx)(kt,{value:{cellMetadata:s,mimeModel:e,queryId:t,saveStateSignal:this.notebookContext.saveState,sessionId:o,sessionLocation:r,widgetComm:this.widgetComm,widgetName:i}},(0,F.jsx)(ds,null))),this.node,(()=>{this.cleanUpFunctions.push((()=>{pt().unmountComponentAtNode(this.node)})),n()}))}))}onAfterAttach(){const e={capture:!0};this.node.addEventListener("contextmenu",this,e),this.cleanUpFunctions.push((()=>{this.node.removeEventListener("contextmenu",this,e)}))}onBeforeDetach(){for(const e of this.cleanUpFunctions)e()}handleEvent(e){if(e instanceof MouseEvent&&!e.shiftKey&&e.target){const t=new MouseEvent("contextmenu",{bubbles:!0,clientX:e.clientX,clientY:e.clientY,shiftKey:!0});e.stopPropagation(),e.preventDefault(),t.initEvent(t.type,!0,!0),e.target.dispatchEvent(t)}}}class cs{constructor(e){this.sharedContext=e}createNew(e,t){const{content:s,model:n}=e;if(null===n)throw new Error("Session model should not be null at this time");const{cells:i}=n,o=new Bt({cellModels:i});s.rendermime.addFactory({createRenderer:()=>new ls({cellModels:i,notebookContext:t,sharedContext:this.sharedContext,widgetComm:o}),defaultRank:0,mimeTypes:[ae],safe:!1});const{sessionContext:r}=t,a=(e,{newValue:t})=>{t&&o.register(t)};r.kernelChanged.connect(a);const d=((e,{cellModels:t})=>(s,n)=>{if("idle"===n)for(const s of(0,ne.toArray)(t).filter((t=>{const s=e.get(t.metadata);return s&&void 0!==s.current&&(0,C.isCodeCellModel)(t)&&t.outputs.length>0&&!se(t.outputs,(e=>"error"===e.type||void 0!==e.data[ae]))})))e.get(s.metadata).current=void 0})(this.sharedContext.widgetStateTrackers,{cellModels:i});return r.statusChanged.connect(d),new ht.DisposableDelegate((()=>{r.kernelChanged.disconnect(a),r.statusChanged.disconnect(d)}))}}window.Cypress&&(window.__UNSTABLE_DATA_TEST_IDS_ENABLED__=!0);const us={async activate(e,t,s,n,i,o){const a=e,{docRegistry:d,shell:l}=a;console.debug(`Activating atoti extension 0.6.1 (relying on ActiveUI SDK ${p})`);const c=new G({widgetPlugins:At}),u=(({undoRedoMenuItemPlugins:e,widgetPlugins:t})=>({cell:Rt([x.gRB,x.ASS,x.BUk]),"cell-style":Rt([x.iOR,x.OT2,x.eyx]),"menu-item":Rt([x.XWS,x.Pmi,x.lJ3,Et,Pt,x.f$L,x.oCn,x._fi,x.A8w,x.Uk4,x.QYw,x.Nn4,x.woi,...e]),widget:Rt(t)}))({undoRedoMenuItemPlugins:(({notebookTracker:e,widgetStateTrackers:t})=>$t.map((s=>({Component:Ut(s,{notebookTracker:e,widgetStateTrackers:t}),key:s,translations:{"en-US":{key:"undo"===s?"Undo":"Redo",nothingToUndoRedo:"Nothing to "+("undo"===s?"undo":"redo")}}}))))({notebookTracker:t,widgetStateTrackers:c}),widgetPlugins:At}),[h,g,m]=await Promise.all([lt.create({pluginRegistry:u,settingRegistry:o}),ut(),qt.create(s)]),y=new Le,w={intlTracker:h,jupyterLab:a,jupyterServerProxyEnabled:g,notebookTracker:t,pluginRegistry:u,sessionClients:y,themeTracker:m,widgetStateTrackers:c},f=new Ge(w);l.add(f,"left",{rank:700}),i&&i.add(f,"atoti-sidebar"),d.addWidgetExtension("Notebook",new cs(w)),d.addWidgetExtension("Notebook",new wt(w)),(()=>{const e=document.createElement("div");e.id=x.pt,e.classList.add(he),document.body.append(e)})(),(({commandPalette:e,intlTracker:t,jupyterLab:s,notebookTracker:n,sessionClients:i,widgetStateTrackers:o})=>{s.commands.addCommand(tt,{async execute(){const{mdx:e,sessionId:t,widgetCreationCode:a}=nt(n),d={...x.TA$.initialState,serverKey:r},l=await ee({code:a,notebookTracker:n,state:d}),c=i.get(t);if(!c)throw new Error("The execution of the created cell should have created the corresponding SessionClient.");const u=o.get(l.model.metadata);if(!u)throw new Error("The execution of the created cell should have created the corresponding WidgetStateTracker.");const h=await(async e=>e.dataModel?e.dataModel:new Promise((t=>{const s=n=>{e.removeDataModelListener(s),t(n)};e.addDataModelListener(s)})))(c.activePivotClient),{widgetStateDerivedFromMdx:g}=(0,v.jf)({dataModels:{[r]:h},mdx:(0,x.Qc3)(e),widgetPlugin:x.TA$,widgetState:d});u.setWidgetState(g),ce({jupyterLab:s})},isVisible:()=>void 0!==nt(n),label:()=>(0,b.createIntl)(t.config).formatMessage({id:`commands.${et}.caption`})}),s.contextMenu.addItem({command:tt,selector:st}),s.contextMenu.addItem({selector:st,type:"separator"}),e&&e.addItem({category:"Notebook Cell Operations",command:tt})})({commandPalette:n,intlTracker:h,jupyterLab:a,notebookTracker:t,sessionClients:y,widgetStateTrackers:c})},autoStart:!0,id:"atoti",optional:[y.ICommandPalette,m.ILayoutRestorer,f.ISettingRegistry],requires:[w.INotebookTracker,y.IThemeManager]}},7147:(e,t,s)=>{var n={"./en-US":[80761,761],"./en-US.js":[80761,761],"./en-US.js.map":[57918,7918]};function i(e){if(!s.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],i=t[0];return s.e(t[1]).then((()=>s(i)))}i.keys=()=>Object.keys(n),i.id=7147,e.exports=i}}]);