"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.dazzler_renderer=t(require("react"),require("react-dom")):e.dazzler_renderer=t(e.React,e.ReactDOM)}(self,(function(e,t){return(self.webpackChunkdazzler_name_=self.webpackChunkdazzler_name_||[]).push([[401],{74853:function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var u=a(n(63240)),c=i(n(93955));t.default=function(e){var t=u.useState(1),n=t[0],o=t[1];return window.dazzler_base_url=e.baseUrl,u.default.createElement("div",{className:"dazzler-renderer"},u.default.createElement(c.default,r({},e,{key:"upd-"+n,hotReload:function(){return o(n+1)}})))}},93955:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var i=a(n(63240)),u=n(55871),c=n(86597),p=n(86855),f=n(58540),d=n(10964),l=n(30299),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={layout:null,ready:!1,page:null,bindings:{},packages:[],reload:!1,rebindings:[],requirements:[],reloading:!1,needRefresh:!1,ties:{}},n.pageApi=u.apiRequest(window.location.href),n.boundComponents={},n.ws=null,n.updateAspects=n.updateAspects.bind(n),n.connect=n.connect.bind(n),n.disconnect=n.disconnect.bind(n),n.onMessage=n.onMessage.bind(n),n}return o(t,e),t.prototype.updateAspects=function(e,t){var n=this;return new Promise((function(r){var o=d.keys(t),a=o.map((function(r){return s(s({},n.state.bindings[r+"@"+e]),{value:t[r]})})).filter((function(e){return e.trigger}));n.state.rebindings.forEach((function(n){n.trigger.identity.test(e)&&(a=d.concat(a,o.filter((function(e){return n.trigger.aspect.test(e)})).map((function(r){return s(s({},n),{value:t[r],trigger:s(s({},n.trigger),{identity:e,aspect:r})})}))))})),d.flatten(o.map((function(r){for(var o=[],a=0;a<n.state.ties.length;a++){var i=n.state.ties[a],u=i.trigger;(u.regex&&u.identity.test(e)&&u.aspect.test(r)||u.identity===e&&u.aspect===r)&&o.push(s(s({},i),{value:t[r]}))}return o}))).forEach((function(e){var t=e.transforms,r=e.value;t&&(r=t.reduce((function(e,t){return l.executeTransform(t.transform,e,t.args,t.next,n.getAspect.bind(n))}),r)),e.targets.forEach((function(e){var t,o=n.boundComponents[e.identity];o&&o.updateAspects(((t={})[e.aspect]=r,t))}))})),a?(a.forEach((function(e){return n.sendBinding(e,e.value)})),r(a.length)):r(0)}))},t.prototype.getAspect=function(e,t){var n=this.boundComponents[e];if(n)return n.getAspect(t)},t.prototype.connect=function(e,t,n,r,o){this.boundComponents[e]={setAspects:t,getAspect:n,matchAspects:r,updateAspects:o}},t.prototype.disconnect=function(e){delete this.boundComponents[e]},t.prototype.onMessage=function(e){var t,n=this,r=JSON.parse(e.data),o=r.identity,s=r.kind,a=r.payload,i=r.storage,u=r.request_id;switch(t="session"===i?window.sessionStorage:window.localStorage,s){case"set-aspect":var l=function(e){return e.setAspects(c.hydrateProps(a,n.updateAspects,n.connect,n.disconnect)).then((function(){return n.updateAspects(o,a)}))};if(r.regex){var h=new RegExp(r.identity);d.keys(this.boundComponents).filter((function(e){return h.test(e)})).map((function(e){return n.boundComponents[e]})).forEach(l)}else l(this.boundComponents[o]);break;case"get-aspect":var m=r.aspect,g=this.boundComponents[o];if(!g)return void this.ws.send(JSON.stringify({kind:s,identity:o,aspect:m,request_id:u,error:"Aspect not found "+o+"."+m}));var v=g.getAspect(m);this.ws.send(JSON.stringify({kind:s,identity:o,aspect:m,value:c.prepareProp(v),request_id:u}));break;case"set-storage":t.setItem(o,JSON.stringify(a));break;case"get-storage":this.ws.send(JSON.stringify({kind:s,identity:o,request_id:u,value:JSON.parse(t.getItem(o))}));break;case"reload":var y=r.filenames,_=r.hot,b=r.refresh,w=r.deleted;if(b)return this.ws.close(),void this.setState({reloading:!0,needRefresh:!0});if(_)return void this.setState({reloading:!0});y.forEach(p.loadRequirement),w.forEach((function(e){return f.disableCss(e.url)}))}},t.prototype.sendBinding=function(e,t){var n=this,r={trigger:s(s({},e.trigger),{value:c.prepareProp(t)}),states:e.states.reduce((function(e,t){if(t.regex){var r=new RegExp(t.identity),o=new RegExp(t.aspect);return d.concat(e,d.flatten(d.keys(n.boundComponents).map((function(e){var a=[];return r.test(e)&&(a=n.boundComponents[e].matchAspects(o).map((function(n){var r=n[0],o=n[1];return s(s({},t),{identity:e,aspect:r,value:c.prepareProp(o)})}))),a}))))}return e.push(s(s({},t),{value:n.boundComponents[t.identity]&&c.prepareProp(n.boundComponents[t.identity].getAspect(t.aspect))})),e}),[]),kind:"binding",page:this.state.page,key:e.key};this.ws.send(JSON.stringify(r))},t.prototype._connectWS=function(){var e=this,t=0,n=!1,r=function(){var o="ws"+(window.location.href.startsWith("https")?"s":"")+"://"+(e.props.baseUrl&&e.props.baseUrl||window.location.host)+"/"+e.state.page+"/ws";e.ws=new WebSocket(o),e.ws.addEventListener("message",e.onMessage),e.ws.onopen=function(){e.state.reloading?(n=!0,e.ws.close(),e.state.needRefresh?window.location.reload():e.props.hotReload()):(e.setState({ready:!0}),t=0)},e.ws.onclose=function(){!n&&t<e.props.retries&&setTimeout((function(){t++,r()}),1e3)}};r()},t.prototype.componentDidMount=function(){var e=this;this.pageApi("",{method:"POST"}).then((function(t){var n=function(e){return new RegExp(e)};e.setState({page:t.page,layout:t.layout,bindings:d.pickBy((function(e){return!e.regex}),t.bindings),rebindings:d.map((function(e){var r=t.bindings[e];return r.trigger=d.evolve({identity:n,aspect:n},r.trigger),r}),d.keys(d.pickBy((function(e){return e.regex}),t.bindings))),packages:t.packages,requirements:t.requirements,ties:d.map((function(e){return e.trigger.regex?d.evolve({trigger:{identity:n,aspect:n}},e):e}),t.ties)},(function(){return p.loadRequirements(t.requirements,t.packages).then((function(){d.keys(t.bindings).length||t.reload?e._connectWS():e.setState({ready:!0})}))}))}))},t.prototype.render=function(){var e=this.state,t=e.layout,n=e.ready,r=e.reloading;if(!n)return i.default.createElement("div",{className:"dazzler-loading-container"},i.default.createElement("div",{className:"dazzler-spin"}),i.default.createElement("div",{className:"dazzler-loading"},"Loading..."));if(r)return i.default.createElement("div",{className:"dazzler-loading-container"},i.default.createElement("div",{className:"dazzler-spin reload"}),i.default.createElement("div",{className:"dazzler-loading"},"Reloading..."));if(!c.isComponent(t))throw new Error("Layout is not a component: "+t);var o=[],s=function(e){o.push(e)},a=c.hydrateComponent(t.name,t.package,t.identity,c.hydrateProps(t.aspects,this.updateAspects,this.connect,this.disconnect,s),this.updateAspects,this.connect,this.disconnect,s);return i.default.createElement("div",{className:"dazzler-rendered"},o.length?o.reduce((function(e,t){return e?i.default.createElement(t,null,e):i.default.createElement(t,null,a)}),null):a)},t}(i.default.Component);t.default=h},41471:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var i=a(n(63240)),u=n(10964),c=n(58540),p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={aspects:t.aspects||{},ready:!1,initial:!1},n.setAspects=n.setAspects.bind(n),n.getAspect=n.getAspect.bind(n),n.updateAspects=n.updateAspects.bind(n),n.matchAspects=n.matchAspects.bind(n),n}return o(t,e),t.prototype.updateAspects=function(e){var t=this;return this.setAspects(e).then((function(){return t.props.updateAspects(t.props.identity,e)}))},t.prototype.setAspects=function(e){var t=this;return new Promise((function(n){t.setState({aspects:s(s({},t.state.aspects),e)},n)}))},t.prototype.getAspect=function(e){return this.state.aspects[e]},t.prototype.matchAspects=function(e){var t=this;return u.keys(this.state.aspects).filter((function(t){return e.test(t)})).map((function(e){return[e,t.state.aspects[e]]}))},t.prototype.componentDidMount=function(){var e=this;this.props.connect(this.props.identity,this.setAspects,this.getAspect,this.matchAspects,this.updateAspects),this.state.initial||this.updateAspects(this.state.aspects).then((function(){return e.setState({ready:!0,initial:!0})}))},t.prototype.componentWillUnmount=function(){this.props.disconnect(this.props.identity)},t.prototype.render=function(){var e=this.props,t=e.component,n=e.component_name,r=e.package_name,o=this.state,a=o.aspects;return o.ready?i.default.cloneElement(t,s(s({},a),{updateAspects:this.updateAspects,identity:this.props.identity,class_name:u.join(" ",u.concat([r.replace("_","-").toLowerCase()+"-"+c.camelToSpinal(n)],a.class_name?a.class_name.split(" "):[]))})):null},t}(i.default.Component);t.default=p},86597:function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.prepareProp=t.hydrateComponent=t.hydrateProps=t.isComponent=void 0;var s=n(10964),a=o(n(63240)),i=o(n(41471));function u(e){return"Object"===s.type(e)&&e.hasOwnProperty("package")&&e.hasOwnProperty("aspects")&&e.hasOwnProperty("name")&&e.hasOwnProperty("identity")}function c(e,t,n,o,s,u,c,p){var f=window[t];if(!f)throw new Error("Invalid package name: "+t);var d=f[e];if(!d)throw new Error("Invalid component name: "+t+"."+e);var l=a.default.createElement(d,o),h=function(p){var f=p.children;return a.default.createElement(i.default,{identity:n,updateAspects:s,component:l,connect:u,package_name:t,component_name:e,aspects:r({children:f},o),disconnect:c,key:"wrapper-"+n})};return d.isContext?(p(h),null):h({})}t.isComponent=u,t.hydrateProps=function e(t,n,o,a,i){var p={};return Object.entries(t).forEach((function(t){var r=t[0],f=t[1];if("Array"===s.type(f))p[r]=f.map((function(t){if(!u(t))return"Object"===s.type(t)?e(t,n,o,a,i):t;var r=e(t.aspects,n,o,a,i);return r.key||(r.key=t.identity),c(t.name,t.package,t.identity,r,n,o,a,i)}));else if(u(f)){var d=e(f.aspects,n,o,a,i);p[r]=c(f.name,f.package,f.identity,d,n,o,a,i)}else"Object"===s.type(f)&&(p[r]=e(f,n,o,a,i))})),r(r({},t),p)},t.hydrateComponent=c,t.prepareProp=function e(t){if(a.default.isValidElement(t)){var n=t.props;return{identity:n.identity,aspects:s.map(e,s.omit(["identity","updateAspects","_name","_package","aspects","key"],n.aspects)),name:n.component_name,package:n.package_name}}return"Array"===s.type(t)?t.map(e):"Object"===s.type(t)?s.map(e,t):t}},92398:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.render=t.Renderer=void 0;var o=r(n(63240)),s=r(n(21569)),a=r(n(74853));t.Renderer=a.default,t.render=function(e,t){var n=e.baseUrl,r=e.ping,i=e.ping_interval,u=e.retries;s.default.render(o.default.createElement(a.default,{baseUrl:n,ping:r,ping_interval:i,retries:u}),t)}},55871:function(e,t){var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0,t.apiRequest=t.xhrRequest=t.JSONHEADERS=void 0;var r=/json/i,o={method:"GET",headers:{},payload:"",json:!0};function s(e,s){return void 0===s&&(s=o),new Promise((function(a,i){var u=n(n({},o),s),c=u.method,p=u.headers,f=u.payload,d=u.json,l=new XMLHttpRequest;l.open(c,e);var h=d?n(n({},t.JSONHEADERS),p):p;Object.keys(h).forEach((function(e){return l.setRequestHeader(e,h[e])})),l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE)if(200===l.status){var t=l.response;r.test(l.getResponseHeader("Content-Type"))&&(t=JSON.parse(l.responseText)),a(t)}else i({error:"RequestError",message:"XHR "+e+" FAILED - STATUS: "+l.status+" MESSAGE: "+l.statusText,status:l.status,xhr:l})},l.onerror=function(e){return i(e)},l.send(d?JSON.stringify(f):f)}))}t.JSONHEADERS={"Content-Type":"application/json"},t.xhrRequest=s,t.apiRequest=function(e){return function(){var t=e+arguments[0],r=arguments[1]||{};return r.headers=n({},r.headers),new Promise((function(e){s(t,r).then(e)}))}}},86855:(e,t,n)=>{t.__esModule=!0,t.loadRequirements=t.loadRequirement=void 0;var r=n(58540),o=n(10964);function s(e){return new Promise((function(t,n){var o,s=e.url,a=e.kind;if("js"===a)o=r.loadScript;else{if("css"!==a)return"map"===a?t():n({error:"Invalid requirement kind: "+a});o=r.loadCss}return o(s).then(t).catch(n)}))}t.loadRequirement=s,t.loadRequirements=function(e,t){return new Promise((function(n,r){var a=[];Object.keys(t).forEach((function(e){var n=t[e];a=(a=a.concat(function(e){return new Promise((function(t){var n=function(e){e.length?s(e[0]).then((function(){return n(o.drop(1,e))})):t(null)};n(e)}))}(n.requirements.filter((function(e){return"js"===e.kind}))))).concat(n.requirements.filter((function(e){return"css"===e.kind})).map(s))})),Promise.all(a).then((function(){var t=0,r=function(){t<e.length?s(e[t]).then((function(){t++,r()})):n()};r()})).catch(r)}))}},30299:(e,t,n)=>{t.__esModule=!0,t.executeTransform=void 0;var r=n(10964),o=function(e){return r.is(Object,e)&&r.has("identity",e)&&r.has("aspect",e)},s=function(e,t){return o(e)?t(e.identity,e.aspect):e},a={ToUpper:function(e){return e.toUpperCase()},ToLower:function(e){return e.toLowerCase()},Format:function(e,t){var n=t.template;return r.is(String,e)||r.is(Number,e)||r.is(Boolean,e)?r.replace("${value}",e,n):r.is(Object,e)?r.reduce((function(e,t){var n=t[0],o=t[1];return r.replace("${"+n+"}",o,e)}),n,r.toPairs(e)):e},Split:function(e,t){var n=t.separator;return r.split(n,e)},Trim:function(e){return r.trim(e)},Add:function(e,t,n){return r.is(Number,t.value)?e+t.value:e+s(t.value,n)},Sub:function(e,t,n){return r.is(Number,t.value)?e-t.value:e-s(t.value,n)},Divide:function(e,t,n){return r.is(Number,t.value)?e/t.value:e/s(t.value,n)},Multiply:function(e,t,n){return r.is(Number,t.value)?e*t.value:e*s(t.value,n)},Modulus:function(e,t,n){return r.is(Number,t.value)?e%t.value:e%s(t.value,n)},ToPrecision:function(e,t){return e.toPrecision(t.precision)},Concat:function(e,t,n){var o=t.other;return r.concat(e,s(o,n))},Slice:function(e,t){return r.slice(t.start,t.stop,e)},Map:function(e,n,r){var o=n.transform;return e.map((function(e){return t.executeTransform(o.transform,e,o.args,o.next,r)}))},Filter:function(e,n,r){var o=n.comparison;return e.filter((function(e){return t.executeTransform(o.transform,e,o.args,o.next,r)}))},Reduce:function(e,n,r){var o=n.transform,a=n.accumulator,i=s(a,r);return e.reduce((function(e,n){return t.executeTransform(o.transform,[e,n],o.args,o.next,r)}),i)},Pluck:function(e,t){var n=t.field;return r.pluck(n,e)},Append:function(e,t,n){return r.concat(e,[s(t.value,n)])},Prepend:function(e,t,n){return r.concat([s(t.value,n)],e)},Insert:function(e,t,n){var o=t.target,a=t.front,i=s(o,n);return a?r.concat([e],i):r.concat(i,[e])},Take:function(e,t,n){var o=t.n;return r.take(s(o,n),e)},Length:function(e){return e.length},Range:function(e,t,n){for(var r=t.start,o=t.end,a=t.step,i=s(r,n),u=s(o,n),c=i,p=[];c<u;)p.push(c),c+=a;return p},Includes:function(e,t,n){return r.includes(s(t.value,n),e)},Find:function(e,n,o){var s=n.comparison;return r.find((function(e){return t.executeTransform(s.transform,e,s.args,s.next,o)}))(e)},Join:function(e,t,n){return r.join(s(t.separator,n),e)},Sort:function(e,n,o){var s=n.transform;return r.sort((function(e,n){return t.executeTransform(s.transform,[e,n],s.args,s.next,o)}),e)},Reverse:function(e){return r.reverse(e)},Unique:function(e){return r.uniq(e)},Zip:function(e,t,n){return r.zip(e,s(t.value,n))},Pick:function(e,t){return r.pick(t.fields,e)},Get:function(e,t){return e[t.field]},Set:function(e,t,n){var r=t.key,o=t.value;return e[r]=s(o,n),e},Put:function(e,t,n){var r=t.key,o=t.target,a=s(o,n);return a[r]=e,a},Merge:function(e,t,n){var s=t.deep,a=t.direction,i=t.other,u=i;return o(i)&&(u=n(i.identity,i.aspect)),"right"===a?s?r.mergeDeepRight(e,u):r.mergeRight(e,u):s?r.mergeDeepLeft(e,u):r.mergeLeft(e,u)},ToJson:function(e){return JSON.stringify(e)},FromJson:function(e){return JSON.parse(e)},ToPairs:function(e){return r.toPairs(e)},FromPairs:function(e){return r.fromPairs(e)},If:function(e,n,r){var o=n.comparison,s=n.then,i=n.otherwise;return(0,a[o.transform])(e,o.args,r)?t.executeTransform(s.transform,e,s.args,s.next,r):i?t.executeTransform(i.transform,e,i.args,i.next,r):e},Equals:function(e,t,n){return r.equals(e,s(t.other,n))},NotEquals:function(e,t,n){return!r.equals(e,s(t.other,n))},Match:function(e,t,n){return new RegExp(s(t.other,n)).test(e)},Greater:function(e,t,n){return e>s(t.other,n)},GreaterOrEquals:function(e,t,n){return e>=s(t.other,n)},Lesser:function(e,t,n){return e<s(t.other,n)},LesserOrEquals:function(e,t,n){return e<=s(t.other,n)},And:function(e,t,n){return e&&s(t.other,n)},Or:function(e,t,n){return e||s(t.other,n)},Not:function(e){return!e},RawValue:function(e,t){return t.value},AspectValue:function(e,t,n){var r=t.target;return n(r.identity,r.aspect)}};t.executeTransform=function(e,n,o,s,i){var u=(0,a[e])(n,o,i);if(s.length){var c=s[0];return t.executeTransform(c.transform,u,c.args,r.concat(c.next,r.drop(1,s)),i)}return u},t.default=a},63240:t=>{t.exports=e},21569:e=>{e.exports=t}},e=>(e.O(0,[660],(()=>(92398,e(e.s=92398)))),e.O())])}));